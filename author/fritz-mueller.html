<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>fritzm.github.io</title>
    <meta name="description" content="">
    <meta name="author" content="Fritz Mueller">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://fritzm.github.io/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="http://fritzm.github.io/theme/bootstrap.min.css" rel="stylesheet">
    <link href="http://fritzm.github.io/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="http://fritzm.github.io/theme/local.css" rel="stylesheet">
    <link href="http://fritzm.github.io/theme/pygments.css" rel="stylesheet">

    <!-- Photoswipe -->
    <link rel="stylesheet" href="http://fritzm.github.io/theme/photoswipe.css">
    <link rel="stylesheet" href="http://fritzm.github.io/theme/default-skin/default-skin.css">
    <script src="http://fritzm.github.io/theme/photoswipe.min.js"></script>
    <script src="http://fritzm.github.io/theme/photoswipe-ui-default.min.js"></script>
    <script src="http://fritzm.github.io/galleries.js"></script>
    <script type="text/javascript">
        var pswipe = function(gname, index) {
            var pswpElement = document.querySelectorAll('.pswp')[0];
            var items = galleries[gname];
            var options = { index: index };
            var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);
            gallery.init();
        };
    </script>

    <!-- So Firefox can bookmark->"abo this site" -->
        <link href="feeds/all.rss.xml" rel="alternate" title="fritzm.github.io" type="application/rss+xml">

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="http://fritzm.github.io">fritzm.github.io</a>

        <div class="nav-collapse">
        <ul class="nav">

        </ul>
        </div>

    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">


<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/unix-and-ms11.html"><h1>PDP-11/45: V6 Unix attempts & MS11-L repairs</h1></a>
Mon 21 January 2019

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>Following up on Noel's suggestion, I decided to give V6 Unix a try to see how it fared in comparison to the
problems seen with RSTS/E V06C.  I recently scored an additional RK05 pack from eBay, and decided to try and
use that so I could keep my current RSTS/E pack intact.</p>
<p>Inspected the pack, and it looked in good shape, clean, with no apparent crashes on the media.  Mounted it up
and was able to do only a partial recovery.  What I got looks like pretty generic RT-11/BASIC-11 stuff, so I'm
not too concerned about attempting a complete recovery.  Went ahead and reformatted the pack, after which I
could read/write the entire pack with no bad sectors.  So now I had two clean packs to work with.</p>
<p>Built a V6 Unix pack image from the Ken Wellsch tape under SIMH (using directions <a href="http://gunkies.org/wiki/Installing_Unix_v6_%28PDP-11%29_on_SIMH">here</a>).  Transferred it over using PDP11GUI, and it
did boot in single-user mode.  However, it immediately dumped core on the first <code>ls</code> command...  Tried a
multi-user Unix boot (what's to lose?) and this actually fared a bit better; able to <code>ls</code>, but still dumped
core when trying to run the C compiler or do anything else memory-intensive.</p>
<p>So, all of this taken together made me (and others collaborating on the troubleshooting on cctalk) think that
I might have a memory issue in the machine.  My machine has a 256KB MS11-L; I had previously spot-checked this
from the front panel by manipulating the KT11-C mapping registers and trying some writes/and reads within each
bank.  This was enough to identify and repair a few major problems (see <a href="http://fritzm.github.io/ms11-debug.html">this</a> older
blog post) and to get me this far.  But I had never thoroughly and substantially beat this card up after
things seemed to be working with RT-11.  There was still also nagging concern that none of the heavier-weight
KT11, MS11, KB11 "exerciser" MAINDEC diagnostics had yet been run to completion on the restored machine
either...</p>
<p>The recommended DEC diagnostic for the MS11-L is ZQMC, but it is complicated, takes a long time to download,
and the available sources don't exactly match the binary.  So, probably better to work up my own standalone
diagnostic to catch and fix obvious things...  Thus followed about a week of part-time work working up and
successively refining the following test code, and repairing identified problems (failed DRAMs) on the MS11-L
along the way.  This code maps and tests every memory location on the MS11-L, using KT11 memory management.
It relocates itself so it can test the lowest physical bank as well.  Tests include all-ones, all-zeros,
write address to location, and a "random" data test which just uses program code test sequence:</p>
<div class="highlight"><pre><span></span>        <span class="nt">KIPDR0</span><span class="o">=</span><span class="nt">172300</span>
        <span class="nt">KIPDR1</span><span class="o">=</span><span class="nt">172302</span>
        <span class="nt">KIPDR2</span><span class="o">=</span><span class="nt">172304</span>
        <span class="nt">KIPDR3</span><span class="o">=</span><span class="nt">172306</span>
        <span class="nt">KIPDR4</span><span class="o">=</span><span class="nt">172310</span>
        <span class="nt">KIPDR5</span><span class="o">=</span><span class="nt">172312</span>
        <span class="nt">KIPDR6</span><span class="o">=</span><span class="nt">172314</span>
        <span class="nt">KIPDR7</span><span class="o">=</span><span class="nt">172316</span>

        <span class="nt">KIPAR0</span><span class="o">=</span><span class="nt">172340</span>
        <span class="nt">KIPAR1</span><span class="o">=</span><span class="nt">172342</span>
        <span class="nt">KIPAR2</span><span class="o">=</span><span class="nt">172344</span>
        <span class="nt">KIPAR3</span><span class="o">=</span><span class="nt">172346</span>
        <span class="nt">KIPAR4</span><span class="o">=</span><span class="nt">172350</span>
        <span class="nt">KIPAR5</span><span class="o">=</span><span class="nt">172352</span>
        <span class="nt">KIPAR6</span><span class="o">=</span><span class="nt">172354</span>
        <span class="nt">KIPAR7</span><span class="o">=</span><span class="nt">172356</span>

        <span class="nt">SR0</span><span class="o">=</span><span class="nt">177572</span>

        <span class="nt">XCSR</span><span class="o">=</span><span class="nt">177564</span>
        <span class="nt">XBUF</span><span class="o">=</span><span class="nt">177566</span>

        <span class="p">.</span><span class="nc">ASECT</span>
        <span class="o">.=</span><span class="nt">1000</span>
<span class="nt">START</span><span class="o">:</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">700</span><span class="o">,</span><span class="nt">SP</span>         <span class="o">;</span><span class="nt">INIT</span> <span class="nt">STACK</span> <span class="nt">POINTER</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">INSTALL</span> <span class="nt">TRAP</span> <span class="nt">CATCHERS</span>

<span class="nt">TRPS</span><span class="o">:</span>   <span class="nt">CLR</span>     <span class="nt">R0</span>              <span class="o">;</span><span class="nt">CURRENT</span> <span class="nt">VECTOR</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">2</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">VECTOR</span> <span class="nt">TARGET</span>
        <span class="nt">CLR</span>     <span class="nt">R2</span>              <span class="o">;</span><span class="nt">HALT</span> <span class="nt">INSTR</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">100</span><span class="o">,</span><span class="nt">R3</span>         <span class="o">;</span><span class="nt">END</span> <span class="nt">VECTOR</span>
<span class="nt">1</span><span class="o">$:</span>     <span class="nt">MOV</span>     <span class="nt">R1</span><span class="o">,(</span><span class="nt">R0</span><span class="o">)+</span>        <span class="o">;</span><span class="nt">STORE</span> <span class="nt">TARGET</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">MOV</span>     <span class="nt">R2</span><span class="o">,(</span><span class="nt">R0</span><span class="o">)+</span>        <span class="o">;</span><span class="nt">STORE</span> <span class="nt">HALT</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">ADD</span>     <span class="p">#</span><span class="nn">4</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">UPDATE</span> <span class="nt">TARGET</span>
        <span class="nt">SOB</span>     <span class="nt">R3</span><span class="o">,</span><span class="nt">1</span><span class="o">$</span>           <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">OVER</span> <span class="nt">VECTORS</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">INIT</span> <span class="nt">AND</span> <span class="nt">ENABLE</span> <span class="nt">MEMORY</span> <span class="nt">MAPPING</span>

<span class="nt">INITM</span><span class="o">:</span>  <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">IPDRS</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">SRC</span> <span class="nt">PDR</span> <span class="nt">INIT</span> <span class="nt">TABLE</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">KIPDR0</span><span class="o">,</span><span class="nt">R1</span>      <span class="o">;</span><span class="nt">DST</span> <span class="nt">KIPDR0</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">10</span><span class="o">,</span><span class="nt">R2</span>          <span class="o">;</span><span class="nt">DO</span> <span class="nt">EIGHT</span> <span class="nt">PDRS</span>
        <span class="nt">MOV</span>     <span class="o">(</span><span class="nt">R0</span><span class="o">)+,(</span><span class="nt">R1</span><span class="o">)+</span>     <span class="o">;</span><span class="nt">COPY</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">SOB</span>     <span class="nt">R2</span><span class="o">,</span><span class="p">.</span><span class="nc">-2</span>          <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">OVER</span> <span class="nt">PDRS</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">IPARS</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">SRC</span> <span class="nt">PAR</span> <span class="nt">INIT</span> <span class="nt">TABLE</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">KIPAR0</span><span class="o">,</span><span class="nt">R1</span>      <span class="o">;</span><span class="nt">DST</span> <span class="nt">KIPAR0</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">10</span><span class="o">,</span><span class="nt">R2</span>          <span class="o">;</span><span class="nt">DO</span> <span class="nt">EIGHT</span> <span class="nt">PARS</span>
        <span class="nt">MOV</span>     <span class="o">(</span><span class="nt">R0</span><span class="o">)+,(</span><span class="nt">R1</span><span class="o">)+</span>     <span class="o">;</span><span class="nt">COPY</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">SOB</span>     <span class="nt">R2</span><span class="o">,</span><span class="p">.</span><span class="nc">-2</span>          <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">OVER</span> <span class="nt">PARS</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">1</span><span class="o">,@</span><span class="p">#</span><span class="nn">SR0</span>        <span class="o">;</span><span class="nt">ENABLE</span> <span class="nt">MEMORY</span> <span class="nt">MGMT</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">TEST</span> <span class="nt">32K</span> <span class="nt">MS11</span> <span class="nt">BANKS</span> <span class="nt">AT</span> <span class="nt">PA</span> <span class="nt">100000</span> <span class="nt">THRU</span> <span class="nt">700000</span><span class="o">,</span>
        <span class="o">;</span>      <span class="nt">RELOCATE</span><span class="o">,</span> <span class="nt">THEN</span> <span class="nt">TEST</span> <span class="nt">BANK</span> <span class="nt">AT</span> <span class="nt">PA</span> <span class="nt">000000</span> 

<span class="nt">DOPASS</span><span class="o">:</span> <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">1000</span><span class="o">,</span><span class="nt">R0</span>        <span class="o">;</span><span class="nt">PAR</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">100000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">DOBANK</span>       <span class="o">;</span><span class="nt">TEST</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">2000</span><span class="o">,</span><span class="nt">R0</span>        <span class="o">;</span><span class="nt">PAR</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">200000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">DOBANK</span>       <span class="o">;</span><span class="nt">TEST</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">3000</span><span class="o">,</span><span class="nt">R0</span>        <span class="o">;</span><span class="nt">PAR</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">300000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">DOBANK</span>       <span class="o">;</span><span class="nt">TEST</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">4000</span><span class="o">,</span><span class="nt">R0</span>        <span class="o">;</span><span class="nt">PAR</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">400000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">DOBANK</span>       <span class="o">;</span><span class="nt">TEST</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">5000</span><span class="o">,</span><span class="nt">R0</span>        <span class="o">;</span><span class="nt">PAR</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">500000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">DOBANK</span>       <span class="o">;</span><span class="nt">TEST</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">6000</span><span class="o">,</span><span class="nt">R0</span>        <span class="o">;</span><span class="nt">PAR</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">600000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">DOBANK</span>       <span class="o">;</span><span class="nt">TEST</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">7000</span><span class="o">,</span><span class="nt">R0</span>        <span class="o">;</span><span class="nt">PAR</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">700000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">DOBANK</span>       <span class="o">;</span><span class="nt">TEST</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">1000</span><span class="o">,</span><span class="nt">R5</span>        <span class="o">;</span><span class="nt">RELOC</span> <span class="nt">TARGET</span> <span class="nt">PA</span><span class="p">:</span><span class="nd">100000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">RELOC</span>        <span class="o">;</span><span class="nt">GO</span> <span class="nt">DO</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">0000</span><span class="o">,</span><span class="nt">R0</span>        <span class="o">;</span><span class="nt">PAR</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">000000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">DOBANK</span>       <span class="o">;</span><span class="nt">TEST</span> <span class="nt">IT</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">ALL</span> <span class="nt">DONE</span> <span class="nt">WITH</span> <span class="nt">PASS</span>

        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">0000</span><span class="o">,</span><span class="nt">R5</span>        <span class="o">;</span><span class="nt">RELOC</span> <span class="nt">TARGET</span> <span class="nt">PA</span><span class="p">:</span><span class="nd">000000</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">RELOC</span>        <span class="o">;</span><span class="nt">GO</span> <span class="nt">DO</span> <span class="nt">IT</span>
        <span class="nt">CLR</span>     <span class="o">@</span><span class="p">#</span><span class="nn">SR0</span>           <span class="o">;</span><span class="nt">DISABLE</span> <span class="nt">MEMORY</span> <span class="nt">MGMT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">PCOMPL</span><span class="o">,</span><span class="nt">R5</span>      <span class="o">;</span><span class="nt">GET</span> <span class="nt">PASS</span> <span class="nt">COMPLETE</span> <span class="nt">MSG</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRSTR</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">HALT</span>                    <span class="o">;</span><span class="nt">ALL</span> <span class="nt">DONE</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">MAP</span> <span class="nt">A</span> <span class="nt">SINGLE</span> <span class="nt">32K</span> <span class="nt">BANK</span> <span class="nt">AT</span> <span class="nt">VA</span> <span class="nt">20000</span>

<span class="nt">DOBANK</span><span class="o">:</span> <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">KIPAR1</span><span class="o">,</span><span class="nt">R1</span>      <span class="o">;</span><span class="nt">WILL</span> <span class="nt">MAP</span> <span class="nt">USING</span> <span class="nt">KIPAR1</span> <span class="nt">THRU</span> <span class="nt">KIPAR4</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">4</span><span class="o">,</span><span class="nt">R3</span>           <span class="o">;</span><span class="nt">FOUR</span> <span class="nt">KIPARS</span> <span class="nt">TO</span> <span class="nt">SET</span>
        <span class="nt">CMP</span>     <span class="nt">R0</span><span class="o">,</span><span class="p">#</span><span class="nn">7000</span>        <span class="o">;</span><span class="nt">UNLESS</span> <span class="nt">WE</span> <span class="nt">ARE</span> <span class="nt">IN</span> <span class="nt">PA</span> <span class="nt">700000</span> <span class="nt">BANK</span><span class="o">...</span>      
        <span class="nt">BNE</span>     <span class="nt">1</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">SKIP</span> <span class="nt">AHEAD</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">3</span><span class="o">,</span><span class="nt">R3</span>           <span class="o">;</span><span class="nt">OTHERWISE</span><span class="o">,</span> <span class="nt">SCALE</span> <span class="nt">BACK</span> <span class="nt">TO</span> <span class="nt">3</span> <span class="nt">KIPARS</span>
<span class="nt">1</span><span class="o">$:</span>     <span class="nt">MOV</span>     <span class="nt">R0</span><span class="o">,(</span><span class="nt">R1</span><span class="o">)+</span>        <span class="o">;</span><span class="nt">SET</span> <span class="nt">A</span> <span class="nt">KIPAR</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">ADD</span>     <span class="p">#</span><span class="nn">200</span><span class="o">,</span><span class="nt">R0</span>         <span class="o">;</span><span class="nt">INCREMENT</span> <span class="nt">VALUE</span> <span class="nt">FOR</span> <span class="nt">NEXT</span> <span class="nt">KIPAR</span>
        <span class="nt">SOB</span>     <span class="nt">R3</span><span class="o">,</span><span class="nt">1</span><span class="o">$</span>           <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">OVER</span> <span class="nt">KIPARS</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">CALCULATE</span> <span class="nt">END</span> <span class="nt">VA</span>

        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">120000</span><span class="o">,</span><span class="nt">R1</span>      <span class="o">;</span><span class="nt">MAPPED</span> <span class="nt">BANK</span> <span class="nt">END</span> <span class="nt">IS</span> <span class="nt">VA</span> <span class="nt">120000</span>
        <span class="nt">CMP</span>     <span class="o">@</span><span class="p">#</span><span class="nn">KIPAR1</span><span class="o">,</span><span class="p">#</span><span class="nn">7000</span>  <span class="o">;</span><span class="nt">UNLESS</span> <span class="nt">WE</span> <span class="nt">ARE</span> <span class="nt">IN</span> <span class="nt">PA</span> <span class="nt">700000</span> <span class="nt">BANK</span><span class="o">...</span>
        <span class="nt">BNE</span>     <span class="nt">ZEROS</span>           <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">SKIP</span> <span class="nt">AHEAD</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">100000</span><span class="o">,</span><span class="nt">R1</span>      <span class="o">;</span><span class="nt">OTHERWISE</span><span class="o">,</span> <span class="nt">END</span> <span class="nt">IS</span> <span class="nt">VA</span> <span class="nt">100000</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">ZEROS</span> <span class="nt">TEST</span>

<span class="nt">ZEROS</span><span class="o">:</span>  <span class="nt">CLR</span>     <span class="nt">R2</span>              <span class="o">;</span><span class="nt">EXPECTED</span> <span class="nt">VALUE</span> <span class="nt">IS</span> <span class="nt">000000</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">20000</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">START</span> <span class="nt">AT</span> <span class="nt">VA</span> <span class="nt">20000</span>
<span class="nt">1</span><span class="o">$:</span>     <span class="nt">MOV</span>     <span class="nt">R2</span><span class="o">,(</span><span class="nt">R0</span><span class="o">)+</span>        <span class="o">;</span><span class="nt">CLEAR</span> <span class="nt">A</span> <span class="nt">WORD</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">CMP</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">AT</span> <span class="nt">END</span><span class="o">?</span>
        <span class="nt">BNE</span>     <span class="nt">1</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">LOOP</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">20000</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">START</span> <span class="nt">AT</span> <span class="nt">VA</span> <span class="nt">20000</span>
<span class="nt">2</span><span class="o">$:</span>     <span class="nt">TST</span>     <span class="o">(</span><span class="nt">R0</span><span class="o">)+</span>           <span class="o">;</span><span class="nt">CHECK</span> <span class="nt">A</span> <span class="nt">WORD</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">BEQ</span>     <span class="nt">3</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">ZERO</span><span class="o">,</span> <span class="nt">SKIP</span> <span class="nt">AHEAD</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRERR</span>        <span class="o">;</span><span class="nt">OTHERWISE</span><span class="o">,</span> <span class="nt">REPORT</span> <span class="nt">ERROR</span>
<span class="nt">3</span><span class="o">$:</span>     <span class="nt">CMP</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">AT</span> <span class="nt">END</span><span class="o">?</span>
        <span class="nt">BNE</span>     <span class="nt">2</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">LOOP</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">ONES</span> <span class="nt">TEST</span>

<span class="nt">ONES</span><span class="o">:</span>   <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">177777</span><span class="o">,</span><span class="nt">R2</span>      <span class="o">;</span><span class="nt">EXPECTED</span> <span class="nt">VALUE</span> <span class="nt">US</span> <span class="nt">177777</span>       
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">20000</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">START</span> <span class="nt">AT</span> <span class="nt">VA</span> <span class="nt">20000</span>
<span class="nt">1</span><span class="o">$:</span>     <span class="nt">MOV</span>     <span class="nt">R2</span><span class="o">,(</span><span class="nt">R0</span><span class="o">)+</span>        <span class="o">;</span><span class="nt">WRITE</span> <span class="nt">A</span> <span class="nt">WORD</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">CMP</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">AT</span> <span class="nt">END</span><span class="o">?</span>
        <span class="nt">BNE</span>     <span class="nt">1</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">LOOP</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">20000</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">START</span> <span class="nt">AT</span> <span class="nt">VA</span> <span class="nt">20000</span>
<span class="nt">2</span><span class="o">$:</span>     <span class="nt">CMP</span>     <span class="o">(</span><span class="nt">R0</span><span class="o">)+,</span><span class="nt">R2</span>        <span class="o">;</span><span class="nt">CHECK</span> <span class="nt">A</span> <span class="nt">WORD</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">BEQ</span>     <span class="nt">3</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">EXPECTED</span> <span class="nt">VALUE</span><span class="o">,</span> <span class="nt">SKIP</span> <span class="nt">AHEAD</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRERR</span>        <span class="o">;</span><span class="nt">OTHERWISE</span><span class="o">,</span> <span class="nt">REPORT</span> <span class="nt">ERROR</span>
<span class="nt">3</span><span class="o">$:</span>     <span class="nt">CMP</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">AT</span> <span class="nt">END</span><span class="o">?</span>
        <span class="nt">BNE</span>     <span class="nt">2</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">LOOP</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">WRITE</span> <span class="nt">LOCATION</span> <span class="nt">WITH</span> <span class="nt">ITS</span> <span class="nt">VA</span> <span class="nt">TEST</span>

<span class="nt">ADDRS</span><span class="o">:</span>  <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">20000</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">START</span> <span class="nt">AT</span> <span class="nt">VA</span> <span class="nt">20000</span>
<span class="nt">1</span><span class="o">$:</span>     <span class="nt">MOV</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R2</span>           <span class="o">;</span><span class="nt">USE</span> <span class="nt">VA</span> <span class="nt">AS</span> <span class="nt">TEST</span> <span class="nt">VALUE</span>
        <span class="nt">MOV</span>     <span class="nt">R2</span><span class="o">,(</span><span class="nt">R0</span><span class="o">)+</span>        <span class="o">;</span><span class="nt">WRITE</span> <span class="nt">A</span> <span class="nt">WORD</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">CMP</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">AT</span> <span class="nt">END</span><span class="o">?</span>
        <span class="nt">BNE</span>     <span class="nt">1</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">LOOP</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">20000</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">START</span> <span class="nt">AT</span> <span class="nt">VA</span> <span class="nt">20000</span>
<span class="nt">2</span><span class="o">$:</span>     <span class="nt">MOV</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R2</span>           <span class="o">;</span><span class="nt">USE</span> <span class="nt">VA</span> <span class="nt">AS</span> <span class="nt">TEST</span> <span class="nt">VALUE</span>
        <span class="nt">CMP</span>     <span class="o">(</span><span class="nt">R0</span><span class="o">)+,</span><span class="nt">R2</span>        <span class="o">;</span><span class="nt">CHECK</span> <span class="nt">A</span> <span class="nt">WORD</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">BEQ</span>     <span class="nt">3</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">EXPECTED</span> <span class="nt">VALUE</span><span class="o">,</span> <span class="nt">SKIP</span> <span class="nt">AHEAD</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRERR</span>        <span class="o">;</span><span class="nt">REPORT</span> <span class="nt">ERROR</span>
<span class="nt">3</span><span class="o">$:</span>     <span class="nt">CMP</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">AT</span> <span class="nt">END</span><span class="o">?</span>
        <span class="nt">BNE</span>     <span class="nt">2</span><span class="o">$</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="s2">&quot;RANDOM&quot;</span> <span class="nt">DATA</span> <span class="nt">TEST</span> <span class="o">(</span><span class="nt">PROGRAM</span> <span class="nt">AS</span> <span class="nt">TEST</span> <span class="nt">DATA</span><span class="o">)</span>

<span class="nt">RNDM</span><span class="o">:</span>   <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">START</span><span class="o">,</span><span class="nt">R2</span>       <span class="o">;</span><span class="nt">SRC</span><span class="o">:</span> <span class="nt">START</span> <span class="nt">OF</span> <span class="nt">PROGRAM</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">20000</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">DST</span><span class="o">:</span> <span class="nt">VA</span> <span class="nt">20000</span>
<span class="nt">1</span><span class="o">$:</span>     <span class="nt">MOV</span>     <span class="o">(</span><span class="nt">R2</span><span class="o">)+,(</span><span class="nt">R0</span><span class="o">)+</span>     <span class="o">;</span><span class="nt">WRITE</span> <span class="nt">A</span> <span class="nt">WORD</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">CMP</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">AT</span> <span class="nt">END</span><span class="o">?</span>
        <span class="nt">BEQ</span>     <span class="nt">2</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">SO</span><span class="o">,</span> <span class="nt">SKIP</span> <span class="nt">AHEAD</span>
        <span class="nt">CMP</span>     <span class="nt">R2</span><span class="o">,</span><span class="p">#</span><span class="nn">END</span>         <span class="o">;</span><span class="nt">TIME</span> <span class="nt">TO</span> <span class="nt">RESET</span> <span class="nt">SRC</span><span class="o">?</span>
        <span class="nt">BLO</span>     <span class="nt">1</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">GO</span> <span class="nt">DO</span> <span class="nt">ANOTHER</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">START</span><span class="o">,</span><span class="nt">R2</span>       <span class="o">;</span><span class="nt">OTHERWISE</span> <span class="nt">RESET</span> <span class="nt">SRC</span>
        <span class="nt">BR</span>      <span class="nt">1</span><span class="o">$</span>              <span class="o">;</span><span class="nt">AND</span> <span class="nt">GO</span> <span class="nt">DO</span> <span class="nt">ANOTHER</span>
<span class="nt">2</span><span class="o">$:</span>     <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">START</span><span class="o">,</span><span class="nt">R2</span>       <span class="o">;</span><span class="nt">SRC1</span><span class="o">:</span> <span class="nt">START</span> <span class="nt">OF</span> <span class="nt">PROGRAM</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">20000</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">SRC2</span><span class="o">:</span> <span class="nt">VA</span> <span class="nt">20000</span>
<span class="nt">3</span><span class="o">$:</span>     <span class="nt">CMP</span>     <span class="o">(</span><span class="nt">R2</span><span class="o">)+,(</span><span class="nt">R0</span><span class="o">)+</span>     <span class="o">;</span><span class="nt">COMPARE</span> <span class="nt">ONE</span> <span class="nt">WORD</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">BEQ</span>     <span class="nt">4</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">SAME</span><span class="o">,</span> <span class="nt">SKIP</span> <span class="nt">AHEAD</span>
        <span class="nt">MOV</span>     <span class="nt">R2</span><span class="o">,</span><span class="nt">-</span><span class="o">(</span><span class="nt">SP</span><span class="o">)</span>        <span class="o">;</span><span class="nt">SAVE</span> <span class="nt">SRC1</span>
        <span class="nt">MOV</span>     <span class="nt">-2</span><span class="o">(</span><span class="nt">R2</span><span class="o">),</span><span class="nt">R2</span>       <span class="o">;</span><span class="nt">FETCH</span> <span class="nt">EXPECTED</span> <span class="nt">VALUE</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRERR</span>        <span class="o">;</span><span class="nt">REPORT</span> <span class="nt">ERROR</span>
        <span class="nt">MOV</span>     <span class="o">(</span><span class="nt">SP</span><span class="o">)+,</span><span class="nt">R2</span>        <span class="o">;</span><span class="nt">RESTORE</span> <span class="nt">SRC1</span>
<span class="nt">4</span><span class="o">$:</span>     <span class="nt">CMP</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">AT</span> <span class="nt">END</span><span class="o">?</span>
        <span class="nt">BEQ</span>     <span class="nt">5</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">SO</span><span class="o">,</span> <span class="nt">SKIP</span> <span class="nt">AHEAD</span>
        <span class="nt">CMP</span>     <span class="nt">R2</span><span class="o">,</span><span class="p">#</span><span class="nn">END</span>         <span class="o">;</span><span class="nt">TIME</span> <span class="nt">TO</span> <span class="nt">RESET</span> <span class="nt">SRC1</span><span class="o">?</span>
        <span class="nt">BLO</span>     <span class="nt">3</span><span class="o">$</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">GO</span> <span class="nt">DO</span> <span class="nt">ANOTHER</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">START</span><span class="o">,</span><span class="nt">R2</span>       <span class="o">;</span><span class="nt">OTHERWISE</span> <span class="nt">RESET</span> <span class="nt">SRC1</span>
        <span class="nt">BR</span>      <span class="nt">3</span><span class="o">$</span>              <span class="o">;</span><span class="nt">AND</span> <span class="nt">GO</span> <span class="nt">DO</span> <span class="nt">ANOTHER</span>

<span class="nt">5</span><span class="o">$:</span>     <span class="nt">RTS</span>     <span class="nt">PC</span>              <span class="o">;</span><span class="nt">TESTS</span> <span class="nt">DONE</span><span class="o">,</span> <span class="nt">RETURN</span> <span class="nt">TO</span> <span class="nt">CALLER</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">RELOCATE</span>

<span class="nt">RELOC</span><span class="o">:</span>  <span class="nt">MOV</span>     <span class="nt">R5</span><span class="o">,@</span><span class="p">#</span><span class="nn">KIPAR1</span>     <span class="o">;</span><span class="nt">MAP</span> <span class="nt">VA</span><span class="p">:</span><span class="nd">020000</span> <span class="nt">-</span><span class="o">&gt;</span> <span class="nt">PA</span><span class="o">:(</span><span class="nt">R5</span><span class="o">&lt;&lt;</span><span class="nt">6</span><span class="o">)</span> 
        <span class="nt">CLR</span>     <span class="nt">R0</span>              <span class="o">;</span><span class="nt">SRC</span> <span class="nt">VA</span><span class="p">:</span><span class="nd">000000</span> 
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">20000</span><span class="o">,</span><span class="nt">R1</span>       <span class="o">;</span><span class="nt">DST</span> <span class="nt">VA</span><span class="p">:</span><span class="nd">020000</span>
        <span class="nt">MOV</span>     <span class="nt">R1</span><span class="o">,</span><span class="nt">R2</span>           <span class="o">;</span><span class="nt">FULL</span> <span class="nt">PAGE</span> <span class="o">(</span><span class="nt">4K</span> <span class="nt">WORDS</span><span class="o">)</span>
        <span class="nt">MOV</span>     <span class="o">(</span><span class="nt">R0</span><span class="o">)+,(</span><span class="nt">R1</span><span class="o">)+</span>     <span class="o">;</span><span class="nt">COPY</span> <span class="nt">A</span> <span class="nt">WORD</span>
        <span class="nt">SOB</span>     <span class="nt">R2</span><span class="o">,</span><span class="p">.</span><span class="nc">-2</span>          <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">UNTIL</span> <span class="nt">DONE</span>
        <span class="nt">MOV</span>     <span class="nt">R5</span><span class="o">,@</span><span class="p">#</span><span class="nn">KIPAR0</span>     <span class="o">;</span><span class="nt">MAP</span> <span class="nt">VA</span><span class="p">:</span><span class="nd">000000</span> <span class="nt">-</span><span class="o">&gt;</span> <span class="nt">PA</span><span class="o">:(</span><span class="nt">R5</span><span class="o">&lt;&lt;</span><span class="nt">6</span><span class="o">)</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">RELSTR</span><span class="o">,</span><span class="nt">R5</span>      <span class="o">;</span><span class="nt">GET</span> <span class="nt">RELOCATED</span> <span class="nt">STRING</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRSTR</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="o">@</span><span class="p">#</span><span class="nn">KIPAR1</span><span class="o">,</span><span class="nt">R5</span>     <span class="o">;</span><span class="nt">GET</span> <span class="nt">RELOCATION</span> <span class="nt">TARGET</span>
        <span class="nt">ASHC</span>    <span class="p">#</span><span class="nn">6</span><span class="o">,</span><span class="nt">R4</span>           <span class="o">;</span><span class="nt">SHIFT</span> <span class="nt">OVER</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">IN</span> <span class="nt">R4</span><span class="p">:</span><span class="nd">R5</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRW18</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">CRLF</span><span class="o">,</span><span class="nt">R5</span>        <span class="o">;</span><span class="nt">GET</span> <span class="nt">CRLF</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRSTR</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">RTS</span>     <span class="nt">PC</span>              <span class="o">;</span><span class="nt">RETURN</span> <span class="nt">TO</span> <span class="nt">CALLER</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">REPORT</span> <span class="nt">AN</span> <span class="nt">ERROR</span>

<span class="nt">PRERR</span><span class="o">:</span>  <span class="nt">MOV</span>     <span class="o">@</span><span class="p">#</span><span class="nn">KIPAR1</span><span class="o">,</span><span class="nt">R5</span>     <span class="o">;</span><span class="nt">GET</span> <span class="nt">KIPAR</span> <span class="nt">FOR</span> <span class="nt">MAPPED</span> <span class="nt">BASE</span>      
        <span class="nt">ASHC</span>    <span class="p">#</span><span class="nn">6</span><span class="o">,</span><span class="nt">R4</span>           <span class="o">;</span><span class="nt">SHIFT</span> <span class="nt">OVER</span> <span class="nt">FOR</span> <span class="nt">PA</span> <span class="nt">IN</span> <span class="nt">R4</span><span class="p">:</span><span class="nd">R5</span>
        <span class="nt">ADD</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R5</span>           <span class="o">;</span><span class="nt">ADD</span> <span class="nt">IN</span> <span class="nt">ERROR</span> <span class="nt">VA</span>
        <span class="nt">ADC</span>     <span class="nt">R4</span>              <span class="o">;</span><span class="nt">CARRY</span> <span class="nt">IF</span> <span class="nt">NECESSSARY</span>
        <span class="nt">SUB</span>     <span class="p">#</span><span class="nn">20002</span><span class="o">,</span><span class="nt">R5</span>       <span class="o">;</span><span class="nt">SUB</span> <span class="nt">VA</span> <span class="nt">OFFSET</span> <span class="nt">AND</span> <span class="nt">BACK</span> <span class="nt">UP</span> <span class="nt">ONE</span>
        <span class="nt">SBC</span>     <span class="nt">R4</span>              <span class="o">;</span><span class="nt">BORROW</span> <span class="nt">IF</span> <span class="nt">NECESSARY</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRW18</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">PHYSICAL</span> <span class="nt">ADDRESS</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">DELIM1</span><span class="o">,</span><span class="nt">R5</span>      <span class="o">;</span><span class="nt">GET</span> <span class="nt">DELIMITER</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRSTR</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="nt">R2</span><span class="o">,</span><span class="nt">R5</span>           <span class="o">;</span><span class="nt">GET</span> <span class="nt">EXPECTED</span> <span class="nt">VALUE</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRW16</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">DELIM2</span><span class="o">,</span><span class="nt">R5</span>      <span class="o">;</span><span class="nt">GET</span> <span class="nt">DELIMETER</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRSTR</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R4</span>           <span class="o">;</span><span class="nt">GET</span> <span class="nt">ADDRESS</span> <span class="nt">AFTER</span> <span class="nt">ERROR</span>
        <span class="nt">MOV</span>     <span class="nt">-</span><span class="o">(</span><span class="nt">R4</span><span class="o">),</span><span class="nt">R5</span>        <span class="o">;</span><span class="nt">BACK</span> <span class="nt">UP</span> <span class="nt">AND</span> <span class="nt">GET</span> <span class="nt">ERROR</span> <span class="nt">VALUE</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRW16</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">CRLF</span><span class="o">,</span><span class="nt">R5</span>        <span class="o">;</span><span class="nt">GET</span> <span class="nt">CRLF</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRSTR</span>        <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">RTS</span>     <span class="nt">PC</span>              <span class="o">;</span><span class="nt">RETURN</span> <span class="nt">TO</span> <span class="nt">CALLER</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">PRINT</span> <span class="nt">SIX</span> <span class="nt">DIGIT</span> <span class="nt">OCTAL</span> <span class="nt">NUMBER</span>

<span class="nt">PRW16</span><span class="o">:</span>  <span class="nt">CLR</span>     <span class="nt">R4</span>              <span class="o">;</span><span class="nt">CLEAR</span> <span class="nt">UPPER</span> <span class="nt">WORD</span>
<span class="nt">PRW18</span><span class="o">:</span>  <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">6</span><span class="o">,</span><span class="nt">R3</span>           <span class="o">;</span><span class="nt">SIX</span> <span class="nt">DIGITS</span> <span class="nt">TO</span> <span class="nt">PRINT</span>
        <span class="nt">ASHC</span>    <span class="p">#</span><span class="nn">1</span><span class="o">,</span><span class="nt">R4</span>           <span class="o">;</span><span class="nt">SHIFT</span> <span class="nt">IN</span> <span class="nt">MSB</span> <span class="nt">OF</span> <span class="nt">LOW</span> <span class="nt">WORD</span>
<span class="nt">1</span><span class="o">$:</span>     <span class="nt">ADD</span>     <span class="p">#</span><span class="nn">60</span><span class="o">,</span><span class="nt">R4</span>          <span class="o">;</span><span class="nt">MAKE</span> <span class="nt">INTO</span> <span class="nt">ASCII</span> <span class="nt">DIGIT</span>
        <span class="nt">MOV</span>     <span class="nt">R4</span><span class="o">,@</span><span class="p">#</span><span class="nn">XBUF</span>       <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">TSTB</span>    <span class="o">@</span><span class="p">#</span><span class="nn">XCSR</span>          <span class="o">;</span><span class="nt">CHECK</span> <span class="nt">IF</span> <span class="nt">XMIT</span> <span class="nt">DONE</span>
        <span class="nt">BPL</span>     <span class="p">.</span><span class="nc">-4</span>             <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">UNTIL</span> <span class="nt">SO</span>
        <span class="nt">CLR</span>     <span class="nt">R4</span>              <span class="o">;</span><span class="nt">RESET</span> <span class="nt">OUTPUT</span> <span class="nt">CHAR</span>
        <span class="nt">ASHC</span>    <span class="p">#</span><span class="nn">3</span><span class="o">,</span><span class="nt">R4</span>           <span class="o">;</span><span class="nt">SHIFT</span> <span class="nt">IN</span> <span class="nt">NEXT</span> <span class="nt">THREE</span> <span class="nt">BITS</span>
        <span class="nt">SOB</span>     <span class="nt">R3</span><span class="o">,</span><span class="nt">1</span><span class="o">$</span>           <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">DIGITS</span>
        <span class="nt">RTS</span>     <span class="nt">PC</span>              <span class="o">;</span><span class="nt">RETURN</span> <span class="nt">TO</span> <span class="nt">CALLER</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">PRINT</span> <span class="nt">NULL-TERMINATED</span> <span class="nt">STRING</span>

<span class="nt">PRSTR</span><span class="o">:</span>  <span class="nt">MOVB</span>    <span class="o">(</span><span class="nt">R5</span><span class="o">)+,@</span><span class="p">#</span><span class="nn">XBUF</span>    <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">ONE</span> <span class="nt">CHAR</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">TSTB</span>    <span class="o">@</span><span class="p">#</span><span class="nn">XCSR</span>          <span class="o">;</span><span class="nt">CHECK</span> <span class="nt">IF</span> <span class="nt">XMIT</span> <span class="nt">DONE</span>
        <span class="nt">BPL</span>     <span class="p">.</span><span class="nc">-4</span>             <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">UNTIL</span> <span class="nt">SO</span>
        <span class="nt">TSTB</span>    <span class="p">@</span><span class="k">R5</span>             <span class="p">;</span><span class="nt">CHECK</span> <span class="nt">IF</span> <span class="nt">END</span> <span class="nt">OF</span> <span class="nt">STRING</span>
        <span class="nt">BNE</span>     <span class="nt">PRSTR</span>           <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">IF</span> <span class="nt">NOT</span>
        <span class="nt">RTS</span>     <span class="nt">PC</span>              <span class="o">;</span><span class="nt">ELSE</span> <span class="nt">RETURN</span> <span class="nt">TO</span> <span class="nt">CALLER</span>

<span class="nt">IPDRS</span><span class="o">:</span>  <span class="p">.</span><span class="nc">WORD</span>   <span class="nt">077406</span><span class="o">,</span><span class="nt">077406</span><span class="o">,</span><span class="nt">077406</span><span class="o">,</span><span class="nt">077406</span>
        <span class="p">.</span><span class="nc">WORD</span>   <span class="nt">077406</span><span class="o">,</span><span class="nt">000000</span><span class="o">,</span><span class="nt">000000</span><span class="o">,</span><span class="nt">077406</span>

<span class="nt">IPARS</span><span class="o">:</span>  <span class="p">.</span><span class="nc">WORD</span>   <span class="nt">000000</span><span class="o">,</span><span class="nt">000200</span><span class="o">,</span><span class="nt">000400</span><span class="o">,</span><span class="nt">000600</span>
        <span class="p">.</span><span class="nc">WORD</span>   <span class="nt">001000</span><span class="o">,</span><span class="nt">000000</span><span class="o">,</span><span class="nt">000000</span><span class="o">,</span><span class="nt">007600</span>

<span class="nt">DELIM1</span><span class="o">:</span> <span class="p">.</span><span class="nc">ASCIZ</span>  <span class="o">/:</span> <span class="o">/</span>            <span class="o">;</span><span class="nt">POST-ADDRESS</span> <span class="nt">DELIMETER</span>
<span class="nt">DELIM2</span><span class="o">:</span> <span class="p">.</span><span class="nc">ASCIZ</span>  <span class="o">/</span> <span class="o">/</span>             <span class="o">;</span><span class="nt">POST-CRC</span> <span class="nt">DELIMETER</span>
<span class="nt">CRLF</span><span class="o">:</span>   <span class="p">.</span><span class="nc">ASCIZ</span>  <span class="o">&lt;</span><span class="nt">15</span><span class="o">&gt;&lt;</span><span class="nt">12</span><span class="o">&gt;</span>        <span class="o">;</span><span class="nt">LINE</span> <span class="nt">DELIMETER</span>
<span class="nt">RELSTR</span><span class="o">:</span> <span class="p">.</span><span class="nc">ASCIZ</span>  <span class="o">/</span><span class="nt">RELOCATED</span> <span class="nt">TO</span> <span class="nt">PA</span><span class="o">:/</span>
<span class="nt">PCOMPL</span><span class="o">:</span> <span class="p">.</span><span class="nc">ASCIZ</span>  <span class="o">/</span><span class="nt">PASS</span> <span class="nt">COMPLETED</span><span class="o">/&lt;</span><span class="nt">15</span><span class="o">&gt;&lt;</span><span class="nt">12</span><span class="o">&gt;&lt;</span><span class="nt">15</span><span class="o">&gt;&lt;</span><span class="nt">12</span><span class="o">&gt;</span>

<span class="nt">END</span><span class="o">:</span>    <span class="p">.</span><span class="nc">END</span>    <span class="nt">START</span>
</pre></div>


<p>The code above is the end result of quite a bit of successive refinement.  Things learned along the way:</p>
<ul>
<li>
<p>At first the tests consisted only of writing and checking all-ones and all-zeros to each location.  This did
uncover one more bank with a stuck bit at only some addresses, that my previous spot-checking had missed.
Lesson: you really gotta check every byte.  Removed, socketed, and replaced the implicated DRAM, and my tests
passed.</p>
</li>
<li>
<p>Maybe I fixed it, so after this I invested the download time to try the the DEC ZQMC diagnostic again.  It
ran better than I had seen before, proceeding through a few subtests, but soon started flagging a lot of
errors that my diagnostic missed. Hmmm.  Inspecting the DEC code, it seemed to be writing and checking random
data at the time, not just all ones an zeros.  Went ahead and implemented "random" data test in my diagnostic,
and it immediately started implicating the same chips.  Lesson: all-ones, all-zeros isn't good enough...</p>
</li>
<li>
<p>While I was at it, I implemented an additional "write/check each byte with its virtual address" test.
Interestingly, this found <em>most</em>, but not <em>all</em> of the same chips as the random data test.  Lesson: all-ones,
all-zeros, and address in each word isn't good enough, either; you really do gotta have that "random" data
test, too. At this point, went ahead and replaced three more implicated DRAMS, and my tests once again passed
clean...</p>
</li>
<li>
<p>In the meantime, I did some more code reading on the DEC diagnostic, and found that various features could
be enabled/disabled via the front panel switches.  With some care, the diagnostic might also be restartable
without having to wait for an entire re-download, if stopped carefully and in the right place.  So I spent the
time to re-download, and found with experimentation that the DEC diagnostic would now pass all banks of memory
cleanly, as long as <em>parity checking was disabled</em>.  Hmm...</p>
</li>
<li>
<p>Moving back to my diagnostic, I noticed that while it ran clean now on all banks, on a fresh power-up it
would usually light the parity-error LED on the MS11-L on its first pass.  Subsequent passes, after every
location had been written at least once, were fine.  Since the MS11-L doesn't have any fancy power-up init
logic, it would make sense to see this if the program read locations without writing them first, but I didn't
think my code did that.  Enabling parity traps let me catch it in the act, and it was happening on a <code>CLR</code>
instruction that I was using to init memory!  Lesson: on an 11/45, <code>CLR</code> is implemented like other single-
operand, modifying instructions, and actually does a DATIP bus cycle from the destination before writing back
a zero!  So use <code>MOV</code> instead of <code>CLR</code> to init memory if you are worried about tripping parity errors...
Cleaned this up in my code, and my diagnostic now runs clean on my machine in all circumstances without ever
tripping a parity error.</p>
</li>
</ul>
<p>So, a lot of issues found and repaired on the MS11-L.  Maybe still some issues with parity error handling,
which seems to be halting the machine instead of taking a trap.  Figured it might be worth a shot to try the
operating systems again, so mounted the respective disks and tried both, and... exact same failures in both
cases!  Womp, womp...</p>
<p>Well, might as well continue to look into the parity error handling, since some things still seem fishy there.
The DEC documentation is a bit murky here; various versions of the KB11-A maintenance manual and 11/45
processor handbook say different and somewhat contradictory things; some info in earlier editions is also
removed form later ones.  The available engineering drawings for the KB11-A CPU look to have some significant
differences from the actual boards I have on hand, and there are more than a few ECO's for these boards listed
as relating specifically to parity handling, but for which no other information is available.  And Noel has
uncovered evidence that even the Unibus signaling related to parity may have been changed by DEC around the
early times of the early 11/45. Could be interesting...</p></div>
    <hr />
</div>



<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/rsts.html"><h1>PDP-11/45: RSTS/E V06C attempts</h1></a>
Mon 07 January 2019

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>Okay, back in action after replacing the failed nand at B26 in the RK11-C.  MAINDEC ZRKK now passes reliably.
Wish I'd been able to get to the bottom of this at the show, but it was really hard to effectively debug on
the floor there while the show was in progress -- you naturally want to stop and chat with everybody who drops
by to take a look, so its hard to get into a good technical flow.</p>
<p>Since one of the RK11-C diagnostics I needed to use writes a pack destructively, I had to sacrifice my working
RT-11 pack along the way.  Rather than go back to the same old RT-11 image, I figured maybe time to try
something different?  RSTS/E would probably be more fun with multiple terminals and the DZ11 that I have
anyway, and I've never actually played around with RSTS.  So decided to give that a go...</p>
<p>Did some poking around looking at various available versions, and V06C seemed like a pretty good starting
point: it's new enough to explicitly support all of my hardware (including the DZ11 and excepting the VT100),
but old enough to still have relatively modest storage requirements so I can hope to run it with the single
RK05 that I currently have working.  There is also complete distribution tape available at rsts.org, and a
fairly complete set of documentation at bitsavers.</p>
<p>Spent a bit of time reading the sysgen manual, and managed to sysgen under simh and generate a bootable
RK05 image for my hardware.  I then transferred this image to my single working pack using PDP11GUI; this is
frustratingly slow (~3 hours to write a 2.5mb pack)!!  I had forgotten how bad this is.  I'm not quite sure
why it is as slow as it is; it shouldn't take much more than 45 minutes to push that much data through a DL11
at 9600 baud, even without compression, and the PDP-11 disk subsystem can easily keep up with that.  I'm not
sure if PDP11GUI is spending a lot of time turning around the serial line, or has a bunch of per-character
overhead, or...?  In any case, I'm motivated to do something about it; more on this some other time soon.</p>
<p>So, unfortunately, the RSTS image which works under simh fails to completely boot on the real hardware. It
runs through the initial "Option:" menu without trouble, and upon start the RSTS light chaser runs in the
data lights on the front panel.  Characters are echoed on the console terminal, but it never reaches code to
print the banner or prompt for the initial control file.  The system appears to be in a loop reading the same
section of disk repetitively, and the display register shows a continuously increasing count.</p>
<p>Got a lot of help from folks over on the cctalk mailing list on this one, since I'm a newbie to RSTS.  Paul K.
provided some useful tips:</p>
<ul>
<li>
<p>RSTS displays an error count in the display register, so that's why I see an increasing count there.</p>
</li>
<li>
<p>The "fancy" idle pattern that includes both the address and data lights apparently shows up in a later
release of RSTS and requires a particular sysgen option, so its not surprising that I only see the pattern
in the data lights on my machine.</p>
</li>
<li>
<p>The ODT debugger may be loaded with RSTS for startup debugging by configuring it using an undocumented
option in the change memory layout section of the "DEFAULT" command at the boot prompt.  Enter "ODT" there,
and provide a space for it in the memory map.  After that, at ^P at the console will take you to the ODT
prompt. </p>
</li>
</ul>
<div class="highlight"><pre><span></span>   Memory allocation table:

     0K: 00000000 - 00123777 (  21K) : EXEC
    21K: 00124000 - 00213777 (  14K) : RTS (BASIC)
    35K: 00214000 - 00227777 (   3K) : ODT
    38K: 00230000 - 00757777 (  86K) : USER
   124K: 00760000 - End              : NXM
</pre></div>


<ul>
<li>A handy way to query the RSTS symbol table is to use the "PATCH" command at the boot prompt (one can also
look through the .MAP files generated during sysgen):</li>
</ul>
<div class="highlight"><pre><span></span>   Option: PA
   File to patch? 
   Module name? 
   Base address? ERL
   Offset address? 
    Base   Offset  Old     New?
   041314  000000  005267  ? ^Z
   Offset address? ^Z
   Base address? 
</pre></div>


<ul>
<li>Paul also provided this procedure for triggering a crash dump from an ODT breakpoint under RSTS:</li>
</ul>
<div class="highlight"><pre><span></span>1. Make sure crash dump is enabled (in the &quot;default&quot; option).  Start the system.  Let it run for at least one minute.  (I&#39;m not entirely sure about older versions, but I think that a crash within one minute of startup is handled differently and doesn&#39;t do all the usual dump and restart machinery.)

2. Set the data switches all UP.  (In SIMH, enter &quot;D SR 177777&quot;.)

3. Set a breakpoint.

4. When you hit the breakpoint, change the PC to 52, like this:

    0B:055244 
    _$7/055244 52 
    _P 

  (you enter only &quot;$7/&quot; and &quot;52&lt;return&gt;&quot; and &quot;P&quot;, the rest is output from ODT.)

  The system will write the crashdump and then automatically restart.

5. You should now have the crash dump in [0,1]CRASH.SYS
</pre></div>


<p>Further experiments coordinated by Paul then led to the conclusion that an error like this could reasonably be
expected to be triggered by a corrupted INIT.BAC or BASIC.RTS file.  This led me to wish to verify that the
disk pack contents really matched the image file I was running successfully under simh.  Some standalone code
to dump a CRC of every sector on the pack seemed like it would be useful in this regard, so I coded up the
following:</p>
<div class="highlight"><pre><span></span>        <span class="nt">RKDS</span><span class="o">=</span><span class="nt">177400</span>
        <span class="nt">RKER</span><span class="o">=</span><span class="nt">177402</span>
        <span class="nt">RKCS</span><span class="o">=</span><span class="nt">177404</span>
        <span class="nt">RKWC</span><span class="o">=</span><span class="nt">177406</span>
        <span class="nt">RKBA</span><span class="o">=</span><span class="nt">177410</span>
        <span class="nt">RKDA</span><span class="o">=</span><span class="nt">177412</span>

        <span class="nt">XCSR</span><span class="o">=</span><span class="nt">177564</span>
        <span class="nt">XBUF</span><span class="o">=</span><span class="nt">177566</span>

        <span class="p">.</span><span class="nc">ASECT</span>
        <span class="o">.=</span><span class="nt">1000</span>
<span class="nt">START</span><span class="o">:</span>  
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">700</span><span class="o">,</span><span class="nt">SP</span>         <span class="o">;</span><span class="nt">INIT</span> <span class="nt">STACK</span> <span class="nt">POINTER</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">INIT</span> <span class="nt">CRC</span> <span class="nt">LOOKUP</span> <span class="nt">TABLE</span>

        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">10041</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">CRC</span> <span class="nt">POLYNOMIAL</span> 
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">CRCTBL</span><span class="o">,</span><span class="nt">R1</span>      <span class="o">;</span><span class="nt">LOOKUP</span> <span class="nt">TABLE</span> <span class="nt">TO</span> <span class="nt">FILL</span>
        <span class="nt">ADD</span>     <span class="p">#</span><span class="nn">1000</span><span class="o">,</span><span class="nt">R1</span>        <span class="o">;</span><span class="nt">START</span> <span class="nt">FILLING</span> <span class="nt">FROM</span> <span class="nt">END</span> <span class="o">(+</span><span class="nt">256</span> <span class="nt">WORDS</span><span class="o">)</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">377</span><span class="o">,</span><span class="nt">R2</span>         <span class="o">;</span><span class="nt">COUNT</span> <span class="nt">DOWN</span> <span class="nt">FROM</span> <span class="nt">INDEX</span> <span class="nt">255</span>
<span class="nt">L0</span><span class="o">:</span>     <span class="nt">MOV</span>     <span class="nt">R2</span><span class="o">,</span><span class="nt">R4</span>           <span class="o">;</span><span class="nt">GET</span> <span class="nt">COPY</span> <span class="nt">OF</span> <span class="nt">INDEX</span>
        <span class="nt">SWAB</span>    <span class="nt">R4</span>              <span class="o">;</span><span class="nt">MOVE</span> <span class="nt">TO</span> <span class="nt">UPPER</span> <span class="nt">BYTE</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">10</span><span class="o">,</span><span class="nt">R3</span>          <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">OVER</span> <span class="nt">EIGHT</span> <span class="nt">BITS</span> <span class="nt">OF</span> <span class="nt">INDEX</span>  
<span class="nt">L1</span><span class="o">:</span>     <span class="nt">ASL</span>     <span class="nt">R4</span>              <span class="o">;</span><span class="nt">SHIFT</span><span class="o">,</span> <span class="nt">MSB</span> <span class="nt">TO</span> <span class="nt">CARRY</span> <span class="nt">FLAG</span>
        <span class="nt">BCC</span>     <span class="nt">L2</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">MSB</span> <span class="nt">NOT</span> <span class="nt">SET</span> <span class="nt">SKIP</span> <span class="nt">AHEAD</span>
        <span class="nt">XOR</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R4</span>           <span class="o">;</span><span class="nt">ELSE</span> <span class="nt">XOR</span> <span class="nt">IN</span> <span class="nt">POLYNOMIAL</span>
<span class="nt">L2</span><span class="o">:</span>     <span class="nt">SOB</span>     <span class="nt">R3</span><span class="o">,</span><span class="nt">L1</span>           <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">OVER</span> <span class="nt">BITS</span>
        <span class="nt">MOV</span>     <span class="nt">R4</span><span class="o">,</span><span class="nt">-</span><span class="o">(</span><span class="nt">R1</span><span class="o">)</span>        <span class="o">;</span><span class="nt">SAVE</span> <span class="nt">RESULT</span> <span class="nt">IN</span> <span class="nt">LOOKUP</span> <span class="nt">TABLE</span>
        <span class="nt">DEC</span>     <span class="nt">R2</span>              <span class="o">;</span><span class="nt">COUNT</span> <span class="nt">DOWN</span>
        <span class="nt">BPL</span>     <span class="nt">L0</span>              <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">OVER</span> <span class="nt">TABLE</span> <span class="nt">ENTRIES</span>

        <span class="nt">CLR</span>     <span class="nt">R5</span>              <span class="o">;</span><span class="nt">INIT</span> <span class="nt">SECTOR</span> <span class="nt">COUNTER</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">PRINT</span> <span class="nt">START</span> <span class="nt">OF</span> <span class="nt">LINE</span>

<span class="nt">L3</span><span class="o">:</span>     <span class="nt">MOV</span>     <span class="nt">R5</span><span class="o">,</span><span class="nt">R0</span>           <span class="o">;</span><span class="nt">GET</span> <span class="nt">SECTOR</span> <span class="nt">COUNTER</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRNW</span>         <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">DELIM1</span><span class="o">,</span><span class="nt">R0</span>      <span class="o">;</span><span class="nt">GET</span> <span class="nt">POST-SECTOR</span> <span class="nt">DELIMETER</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRNSTR</span>       <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">READ</span> <span class="nt">8</span> <span class="nt">SECTORS</span> <span class="nt">FROM</span> <span class="nt">DISK</span>

<span class="nt">L4</span><span class="o">:</span>     <span class="nt">MOV</span>     <span class="nt">R5</span><span class="o">,@</span><span class="p">#</span><span class="nn">RKDA</span>       <span class="o">;</span><span class="nt">SET</span> <span class="nt">START</span> <span class="nt">SECTOR</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">DBUF</span><span class="o">,@</span><span class="p">#</span><span class="nn">RKBA</span>    <span class="o">;</span><span class="nt">SET</span> <span class="nt">TARGET</span> <span class="nt">ADDRESS</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">-4000</span><span class="o">,@</span><span class="p">#</span><span class="nn">RKWC</span>   <span class="o">;</span><span class="nt">READ</span> <span class="nt">8</span> <span class="nt">SECTORS</span> <span class="o">(</span><span class="nt">2K</span> <span class="nt">WORDS</span><span class="o">)</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">5</span><span class="o">,@</span><span class="p">#</span><span class="nn">RKCS</span>       <span class="o">;</span><span class="nt">READ</span> <span class="o">+</span> <span class="nt">GO</span>
        <span class="nt">TSTB</span>    <span class="o">@</span><span class="p">#</span><span class="nn">RKCS</span>          <span class="o">;</span><span class="nt">CHECK</span> <span class="nt">RKCS</span> <span class="nt">RDY</span> <span class="nt">BIT</span>
        <span class="nt">BPL</span>     <span class="p">.</span><span class="nc">-4</span>             <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">IF</span> <span class="nt">BUSY</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">HANDLE</span> <span class="nt">ERROR</span> <span class="nt">IF</span> <span class="nt">ANY</span>

        <span class="nt">BIT</span>     <span class="p">#</span><span class="nn">100000</span><span class="o">,@</span><span class="p">#</span><span class="nn">RKCS</span>  <span class="o">;</span><span class="nt">CHECK</span> <span class="nt">FOR</span> <span class="nt">ERROR</span>
        <span class="nt">BEQ</span>     <span class="nt">L5</span>              <span class="o">;</span><span class="nt">SKIP</span> <span class="nt">AHEAD</span> <span class="nt">IF</span> <span class="nt">NOT</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">ERRSTR</span><span class="o">,</span><span class="nt">R0</span>      <span class="o">;</span><span class="nt">POINT</span> <span class="nt">TO</span> <span class="nt">ERROR</span> <span class="nt">INDICATOR</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRNSTR</span>       <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">MOV</span>     <span class="o">@</span><span class="p">#</span><span class="nn">RKER</span><span class="o">,</span><span class="nt">R0</span>       <span class="o">;</span><span class="nt">GET</span> <span class="nt">ERROR</span> <span class="nt">REG</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRNW</span>         <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">BR</span>      <span class="nt">L8</span>              <span class="o">;</span><span class="nt">MOVE</span> <span class="nt">ON</span> <span class="nt">TO</span> <span class="nt">NEXT</span> <span class="nt">8</span> <span class="nt">SECTORS</span>

<span class="nt">L5</span><span class="o">:</span>     <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">DBUF</span><span class="o">,</span><span class="nt">R4</span>        <span class="o">;</span><span class="nt">POINT</span> <span class="nt">TO</span> <span class="nt">START</span> <span class="nt">OF</span> <span class="nt">DATA</span> <span class="nt">JUST</span> <span class="nt">READ</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">RUN</span> <span class="nt">CRC</span> <span class="nt">FOR</span> <span class="nt">ONE</span> <span class="nt">SECTOR</span><span class="o">.</span>  <span class="nt">FOR</span> <span class="nt">EACH</span> <span class="nt">INPUT</span> <span class="nt">BYTE</span> <span class="nt">CH</span><span class="o">:</span>
        <span class="o">;</span>       <span class="nt">CRC</span> <span class="o">=</span> <span class="nt">CRCTBL</span><span class="cp">[</span><span class="p">((</span><span class="nx">CRC</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="p">^</span> <span class="nx">CH</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">255</span><span class="cp">]</span> <span class="o">^</span> <span class="o">(</span><span class="nt">CRC</span> <span class="o">&lt;&lt;</span> <span class="nt">8</span><span class="o">)</span>

<span class="nt">L6</span><span class="o">:</span>     <span class="nt">CLR</span>     <span class="nt">R0</span>              <span class="o">;</span><span class="nt">RESET</span> <span class="nt">CRC</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">1000</span><span class="o">,</span><span class="nt">R1</span>        <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">OVER</span> <span class="nt">ONE</span> <span class="nt">SECTOR</span> <span class="o">(</span><span class="nt">256</span> <span class="nt">WORDS</span><span class="o">)</span>
<span class="nt">L7</span><span class="o">:</span>     <span class="nt">MOV</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R2</span>           <span class="o">;</span><span class="nt">GET</span> <span class="nt">COPY</span> <span class="nt">OF</span> <span class="nt">CRC</span>
        <span class="nt">SWAB</span>    <span class="nt">R2</span>              <span class="o">;</span><span class="nt">MOVE</span> <span class="nt">HIGH</span> <span class="nt">BYTE</span> <span class="nt">DOWN</span>
        <span class="nt">MOVB</span>    <span class="o">(</span><span class="nt">R4</span><span class="o">)+,</span><span class="nt">R3</span>        <span class="o">;</span><span class="nt">GET</span> <span class="nt">NEXT</span> <span class="nt">INPUT</span> <span class="nt">BYTE</span> <span class="nt">TO</span> <span class="nt">PROCESS</span>
        <span class="nt">XOR</span>     <span class="nt">R3</span><span class="o">,</span><span class="nt">R2</span>           <span class="o">;</span><span class="nt">XOR</span> <span class="nt">ONTO</span> <span class="nt">MUNGED</span> <span class="nt">CRC</span>
        <span class="nt">BIC</span>     <span class="p">#</span><span class="nn">177400</span><span class="o">,</span><span class="nt">R2</span>      <span class="o">;</span><span class="nt">MASK</span> <span class="nt">OFF</span> <span class="nt">HIGH</span> <span class="nt">BYTE</span>
        <span class="nt">ASL</span>     <span class="nt">R2</span>              <span class="o">;</span><span class="nt">TIMES</span> <span class="nt">TWO</span> <span class="nt">INDEX</span> <span class="nt">INTO</span> <span class="nt">LOOKUP</span> <span class="nt">TABLE</span>
        <span class="nt">MOV</span>     <span class="nt">CRCTBL</span><span class="o">(</span><span class="nt">R2</span><span class="o">),</span><span class="nt">R3</span>   <span class="o">;</span><span class="nt">LOOKUP</span> <span class="nt">VALUE</span>
        <span class="nt">SWAB</span>    <span class="nt">R0</span>              <span class="o">;</span><span class="nt">MOVE</span> <span class="nt">LOW</span> <span class="nt">BYTE</span> <span class="nt">OF</span> <span class="nt">CRC</span> <span class="nt">UP</span>
        <span class="nt">CLRB</span>    <span class="nt">R0</span>              <span class="o">;</span><span class="nt">MASK</span> <span class="nt">OFF</span> <span class="nt">THE</span> <span class="nt">BOTTOM</span>
        <span class="nt">XOR</span>     <span class="nt">R3</span><span class="o">,</span><span class="nt">R0</span>           <span class="o">;</span><span class="nt">XOR</span> <span class="nt">IN</span> <span class="nt">THE</span> <span class="nt">LOOKED</span> <span class="nt">UP</span> <span class="nt">VALUE</span>
        <span class="nt">SOB</span>     <span class="nt">R1</span><span class="o">,</span><span class="nt">L7</span>           <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">OVER</span> <span class="nt">BYTES</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">PRINT</span> <span class="nt">CRC</span><span class="o">,</span> <span class="nt">DELIMIT</span> <span class="nt">AND</span> <span class="nt">LOOP</span>

        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRNW</span>         <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">CRC</span><span class="o">,</span> <span class="nt">ALREADY</span> <span class="nt">IN</span> <span class="nt">R0</span>
        <span class="nt">CMP</span>     <span class="nt">R4</span><span class="o">,</span><span class="p">#</span><span class="nn">DBUF</span><span class="o">+</span><span class="nt">10000</span>  <span class="o">;</span><span class="nt">END</span> <span class="nt">OF</span> <span class="nt">DISK</span> <span class="nt">BUFFER</span><span class="o">?</span>
        <span class="nt">BEQ</span>     <span class="nt">L8</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">SO</span><span class="o">,</span> <span class="nt">EXIT</span> <span class="nt">LOOP</span>
        <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">DELIM2</span><span class="o">,</span><span class="nt">R0</span>      <span class="o">;</span><span class="nt">ELSE</span> <span class="nt">POINT</span> <span class="nt">TO</span> <span class="nt">POST-CRC</span> <span class="nt">DELIMETER</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRNSTR</span>       <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">BR</span>      <span class="nt">L6</span>              <span class="o">;</span><span class="nt">GO</span> <span class="nt">DO</span> <span class="nt">ANOTHER</span> <span class="nt">SECTOR</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">DELIMIT</span> <span class="nt">END</span> <span class="nt">OF</span> <span class="nt">LINE</span><span class="o">,</span> <span class="nt">LOOP</span> 

<span class="nt">L8</span><span class="o">:</span>     <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">CRLF</span><span class="o">,</span><span class="nt">R0</span>        <span class="o">;</span><span class="nt">POINT</span> <span class="nt">TO</span> <span class="nt">LINE</span> <span class="nt">DELIMETER</span>
        <span class="nt">JSR</span>     <span class="nt">PC</span><span class="o">,</span><span class="nt">PRNSTR</span>       <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">ADD</span>     <span class="p">#</span><span class="nn">10</span><span class="o">,</span><span class="nt">R5</span>          <span class="o">;</span><span class="nt">MOVE</span> <span class="nt">AHEAD</span> <span class="nt">8</span> <span class="nt">SECTORS</span>
        <span class="nt">CMP</span>     <span class="nt">R5</span><span class="o">,</span><span class="p">#</span><span class="nn">11410</span>       <span class="o">;</span><span class="nt">AT</span> <span class="nt">END</span> <span class="nt">OF</span> <span class="nt">PACK</span><span class="o">?</span>
        <span class="nt">BLT</span>     <span class="nt">L3</span>              <span class="o">;</span><span class="nt">IF</span> <span class="nt">NOT</span><span class="o">,</span> <span class="nt">GO</span> <span class="nt">DO</span> <span class="nt">THE</span> <span class="nt">NEXT</span> <span class="nt">8</span>

        <span class="nt">HALT</span>                    <span class="o">;</span><span class="nt">ALL</span> <span class="nt">DONE</span><span class="o">!</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">PRINT</span> <span class="nt">A</span> <span class="nt">WORD</span> <span class="nt">IN</span> <span class="nt">OCTAL</span>

<span class="nt">PRNW</span><span class="o">:</span>   <span class="nt">MOV</span>     <span class="p">#</span><span class="nn">6</span><span class="o">,</span><span class="nt">R2</span>           <span class="o">;</span><span class="nt">SIX</span> <span class="nt">DIGITS</span> <span class="nt">TO</span> <span class="nt">PRINT</span>
        <span class="nt">MOV</span>     <span class="nt">R0</span><span class="o">,</span><span class="nt">R1</span>           <span class="o">;</span><span class="nt">MOVE</span> <span class="nt">OUTPUT</span> <span class="nt">WORD</span> <span class="nt">OVER</span> <span class="nt">TO</span> <span class="nt">R1</span>
        <span class="nt">CLR</span>     <span class="nt">R0</span>              <span class="o">;</span><span class="nt">RESET</span> <span class="nt">OUTPUT</span> <span class="nt">CHAR</span>
        <span class="nt">ASHC</span>    <span class="p">#</span><span class="nn">1</span><span class="o">,</span><span class="nt">R0</span>           <span class="o">;</span><span class="nt">AND</span> <span class="nt">SHIFT</span> <span class="nt">IN</span> <span class="nt">MSB</span> <span class="nt">TO</span> <span class="nt">START</span>
<span class="nt">L9</span><span class="o">:</span>     <span class="nt">ADD</span>     <span class="p">#</span><span class="nn">60</span><span class="o">,</span><span class="nt">R0</span>          <span class="o">;</span><span class="nt">MAKE</span> <span class="nt">INTO</span> <span class="nt">ASCII</span> <span class="nt">DIGIT</span>
        <span class="nt">MOV</span>     <span class="nt">R0</span><span class="o">,@</span><span class="p">#</span><span class="nn">XBUF</span>       <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">IT</span>
        <span class="nt">TSTB</span>    <span class="o">@</span><span class="p">#</span><span class="nn">XCSR</span>          <span class="o">;</span><span class="nt">CHECK</span> <span class="nt">IF</span> <span class="nt">XMIT</span> <span class="nt">DONE</span>
        <span class="nt">BPL</span>     <span class="p">.</span><span class="nc">-4</span>             <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">UNTIL</span> <span class="nt">SO</span>
        <span class="nt">CLR</span>     <span class="nt">R0</span>              <span class="o">;</span><span class="nt">RESET</span> <span class="nt">OUTPUT</span> <span class="nt">CHAR</span>
        <span class="nt">ASHC</span>    <span class="p">#</span><span class="nn">3</span><span class="o">,</span><span class="nt">R0</span>           <span class="o">;</span><span class="nt">SHIFT</span> <span class="nt">IN</span> <span class="nt">NEXT</span> <span class="nt">THREE</span> <span class="nt">BITS</span>
        <span class="nt">SOB</span>     <span class="nt">R2</span><span class="o">,</span><span class="nt">L9</span>           <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">DIGITS</span>
        <span class="nt">RTS</span>     <span class="nt">PC</span>              <span class="o">;</span><span class="nt">RETURN</span> <span class="nt">TO</span> <span class="nt">CALLER</span>

        <span class="o">;</span><span class="nt">-----</span> <span class="nt">PRINT</span> <span class="nt">A</span> <span class="nt">NULL-TERMINATED</span> <span class="nt">STRING</span>

<span class="nt">PRNSTR</span><span class="o">:</span> <span class="nt">MOVB</span>    <span class="o">(</span><span class="nt">R0</span><span class="o">)+,@</span><span class="p">#</span><span class="nn">XBUF</span>    <span class="o">;</span><span class="nt">PRINT</span> <span class="nt">ONE</span> <span class="nt">CHAR</span> <span class="nt">AND</span> <span class="nt">ADVANCE</span>
        <span class="nt">TSTB</span>    <span class="o">@</span><span class="p">#</span><span class="nn">XCSR</span>          <span class="o">;</span><span class="nt">CHECK</span> <span class="nt">IF</span> <span class="nt">XMIT</span> <span class="nt">DONE</span>
        <span class="nt">BPL</span>     <span class="p">.</span><span class="nc">-4</span>             <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">UNTIL</span> <span class="nt">SO</span>
        <span class="nt">TSTB</span>    <span class="p">@</span><span class="k">R0</span>             <span class="p">;</span><span class="nt">CHECK</span> <span class="nt">IF</span> <span class="nt">END</span> <span class="nt">OF</span> <span class="nt">STRING</span>
        <span class="nt">BNE</span>     <span class="nt">PRNSTR</span>          <span class="o">;</span><span class="nt">LOOP</span> <span class="nt">IF</span> <span class="nt">NOT</span>
        <span class="nt">RTS</span>     <span class="nt">PC</span>              <span class="o">;</span><span class="nt">ELSE</span> <span class="nt">RETURN</span> <span class="nt">TO</span> <span class="nt">CALLER</span>

<span class="nt">DELIM1</span><span class="o">:</span> <span class="p">.</span><span class="nc">ASCIZ</span>  <span class="o">/:</span> <span class="o">/</span>            <span class="o">;</span><span class="nt">POST-SECTOR</span> <span class="nt">DELIMETER</span>
<span class="nt">DELIM2</span><span class="o">:</span> <span class="p">.</span><span class="nc">ASCIZ</span>  <span class="o">/</span> <span class="o">/</span>             <span class="o">;</span><span class="nt">POST-CRC</span> <span class="nt">DELIMETER</span>
<span class="nt">CRLF</span><span class="o">:</span>   <span class="p">.</span><span class="nc">ASCIZ</span>  <span class="o">&lt;</span><span class="nt">15</span><span class="o">&gt;&lt;</span><span class="nt">12</span><span class="o">&gt;</span>        <span class="o">;</span><span class="nt">LINE</span> <span class="nt">DELIMETER</span>
<span class="nt">ERRSTR</span><span class="o">:</span> <span class="p">.</span><span class="nc">ASCIZ</span>  <span class="o">/</span><span class="nt">ERROR</span><span class="o">:</span> <span class="o">/</span>       <span class="o">;</span><span class="nt">ERROR</span> <span class="nt">INDICATOR</span>

<span class="nt">CRCTBL</span><span class="o">:</span> <span class="p">.</span><span class="nc">BLKW</span>   <span class="nt">400</span>             <span class="o">;</span><span class="nt">CRC</span> <span class="nt">LOOKUP</span> <span class="nt">TABLE</span>
<span class="nt">DBUF</span><span class="o">:</span>   <span class="p">.</span><span class="nc">BLKW</span>   <span class="nt">4000</span>            <span class="o">;</span><span class="nt">DISK</span> <span class="nt">DATA</span> <span class="nt">BUFFER</span>

        <span class="p">.</span><span class="nc">END</span>    <span class="nt">START</span>
</pre></div>


<p>Running this indicated the RSTS pack was in good shape, and not corrupt.  So, maybe I have had a lurking
hardware bug in my memory system (a 256KB MS11-L), which never tripped up RT-11 and so has to date
gone undiagnosed?</p>
<p>At this point, Noel suggested on cctalk that I give Release 6 Unix a try as well, and see if it suffers
similarly.  Worth a shot!  Out of time for now, and back to the day gig tomorrow after holiday break.
Happy new year, all!</p></div>
    <hr />
</div>



<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/behaving-badly.html"><h1>PDP-11/45 Behaving Badly</h1></a>
Sun 09 December 2018

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>Wow, a year to the day since the previous post here!  Not a lot of PDP-11 work this past year, with lots of
other stuff like home improvements going on, but a few things worth catching up on here.</p>
<p>Mainly, I got brave this past year and decided to actually rent a van and take the 11/45 out of the basement
to the VCF West show at the Computer History Museum in Mountain View.  This was a <em>lot</em> more physical work
than I had anticipated.  Working on this thing a piece at a time, sitting in one place in the basement, you
get kind of used to it and forget how much iron it actually is...  But breaking it down, loading it into a
van, unloading into the show, reassembling, then reversing the whole process at the end of the show is a stark
reminder, both of the size of the machine and of my advancing age, ha!  A <em>huge</em> thank-you to my workmate
Brian, who selflessly gave up a weekend, a vacation day, and some mileage on his back to give me
a hand.  He has already informed me that "the answer for next year is 'no'." :-)</p>
<p><img src='/images/pdp11/VCFW3_thumbnail_tall.jpg' title='Reassembly on the VCF West show floor' onclick='pswipe("pdp11",76);'/>
<img src='/images/pdp11/VCFW1_thumbnail_tall.jpg' title='Running diagnostics and consulting the RK11-C prints...' onclick='pswipe("pdp11",77);'/>
<img src='/images/pdp11/VCFW2_thumbnail_tall.jpg' title='Pavl stops by with an RX02 and controller to help out with debug.  Replacement KM11 debug board visible in the upper diagnostic port of the RK11-C.' onclick='pswipe("pdp11",78);'/>
<img src='/images/pdp11/VCFW4_thumbnail_tall.jpg' title='With Pete Richert, an old friend from Digidesign days!' onclick='pswipe("pdp11",79);'/></p>
<p>I suppose I should have expected it, but in the course of transportation to the show something shook loose resulting in a machine that wouldn't boot RT-11 when reassembled on the show floor (stupid bumpy rental
van!)  So my show became a two day live-troubleshooting exhibit.  This was fine, and I think a lot of
folks had fun jumping in and helping with troubleshooting (thanks, all!)  There was a lot of interest and
reminiscence about the machine and I met a lot of nice people.  Still, a little disappointing, because I
really had wanted people to be able to sit down and use the machine, and also because my head ended up in the
machine the whole time I really didn't get to see the rest of the show or talk to other people about their
exhibits!  Ah well.  In the end I did cajole a successful boot out of it, 15 mins. before the show closed, so
at least a couple people got to sit down and play Adventure.  Placed 3rd in the restoration category :-)</p>
<p>So, what went wrong?  At the show I managed to isolate the problem to something intermittent related to
interrupts from the RK11-C controller.  I was still able to boot the RKDP diagnostic pack, since its
bootstrap and monitor make very conservative use of processor and device interface features.  Running through
the diagnostics, managed to narrow down the problem to RK11-C completion polling after overlapped seeks.  I
guess RT-11 makes use of this feature.</p>
<p>I got the machine home and reassembled, and verified that the problem was still manifesting.  Then many months
passed, until I found some time to dig deeper into the problem just last night.  The relevant failing
diagnostic is ZRKK test 37, and the output is:</p>
<div class="highlight"><pre><span></span>DRIVE 0

RK11 DIDN&#39;T INTRUPT AFTER SK COMPLETED
  PC     RKCS    RKER    RKDS
014476  000310  000000  004713


SCP DIDN&#39;T SET AFTER SEEK WAS DONE
  PC   RKCS
014526  000310


RK11 DIDN&#39;T INTRUPT AFTER SK COMPLETED
  PC     RKCS    RKER    RKDS
014476  000310  000000  004712


SCP DIDN&#39;T SET AFTER SEEK WAS DONE
  PC   RKCS
014526  000310


TIMOUT,PC=004536
</pre></div>


<p>And the relevant bit of the diagnostic listing:</p>
<div class="highlight"><pre><span></span>014362  2$:     MOV     RKVEC,R1
014366          MOV     #3$,(R1)+               ;SET UP VECTOR ADRES FOR RK11 INTERUPT
014372          MOV     #340,(R1)               ;SET UP PSW ON INTERRUPT
014376          BIS     #40,@RKDA               ;ADRES CYLINDER #1
014404          MOV     #111,@R0                ;SEEK, GO WITH IDE SET
014410          WAT.INT ,300                    ;WAIT FOR THE DRIVE TO
                                                ;INTERRUPT AFTER ADRES WAS RECVD
                                                ;WAITING TIME= 1.4 MS FOR 11/20
                                                ;280 US FOR 11/45
                                                ;ERROR, IF INTERUPT DID NOT OCCUR
                                                ;BY NOW
014414          MOV     #BADINT,@RKVEC          ;RESTORE UNEXPECTED RK11 INTERRUPT
014422          MOV     @R0,$REG0               ;GET RKCS
014426          ERROR   75                      ;INTERRUPT DID NOT OCCUR AFTER
                                                ;SEEK WAS INITIATED WITH IDE SET
014430          BR      3$+4
014432  3$:     CMP     (SP)+,(SP)+             ;OK, IF RK11 INTERRUPTED TO THIS
                                                ;RESTORE STACK POINTER (FROM RK11 INTERRUPT)
014434          CMP     (SP)+,(SP)+             ;RESTORE STACK POINTER (FROM
                                                ;WAT.INT)
014436          MOV     #5$,@RKVEC              ;SET UP NEW VECTOR ADRES FOR RK11
014444          BIT     #20000,@R0              ;IS SCP CLEAR
014450          BEQ     4$                      ;YES, BRANCH
014452          MOV     @R0,$REG0               ;GET RKCS
014456          ERROR   76                      ;SCP SET BEFORE SEEK TO LAST
                                                ;CYLINDER WAS DONE
014460  4$:     WAT.INT ,56700                  ;WAIT FOR DRIVE TO INTERRUPT
                                                ;AFTER SEEK WAS COMPLETED
                                                ;WAITING TIME=180 MS FOR 11/20
                                                ;36 MS FOR 11/45
014464          MOV     #BADINT,@RKVEC          :IT&#39;S AN ERROR IF BY THIS TIME
                                                ;INTERRUPT HAS NOT OCCURERED
014472          JSR     PC,GT3RG                ;GO GET RKCS, ER, DS
014476          ERROR   77                      ;RK11 DID NOT INTERRUPT AFTER SEEK (TO
                                                ;LAST CYLINDER) WAS DONE WITH IDE SET
014500          BR      5$+2
014502  5$:     CMP     (SP)+,(SP)+             ;OK, IF RK11 INTERUPTED TO THIS AFTER
                                                ;SEEK WAS COMPLETED. RESTORE
                                                ;STACK POINTER (FROM RK11 INTERRUPT)
014504          CMP     (SP)+,(SP)+             ;RESTORE STACK POINTER (FROM
                                                ;WAT.INT)
014506          MOV     #BADINT,@RKVEC          ;RESTORE RK11 INTERRUPT VECTOR ADRES
                                                ;FOR UNEXPECTED INTERUTS
014514          BIT     #20000,@R0              ;DID SCP BIT SET?
014520          BNE     6$                      ;YES, BRANCH
014522          MOV     @R0,$REG0               ;GET RKCS
014526          ERROR   53                      ;SCP DID NOT SET AFTER RK11 INTERRUPTED
                                                ;INDICATING SEEK WAS
</pre></div>


<p>So, based on the fact that we don't hit error 75 from 14426 (and the fact that the previous test, #36, in
this diagnostic is passing) unlike some previous issues the RK11 here <em>is</em> able to generate interrupts and the
11/45 CPU is fielding them.  The issue seems related to the seek completion polling circuitry on the RK11.</p>
<p>This circuitry is described in section 3.3.2 of the RK11-C manual, and is detailed in engineering drawings
D-BS-RK11-C-12, sheets 1 and 2.  When a seek or reset is in progress for any drive and the IDE bit in the
controller is set, the controller will poll all drives for completion when it is otherwise idle.  When
polling is active, a pulse train which drives a count through the polled drives should be visible at B27F2:</p>
<p><img style="display:block; margin-left:auto; margin-right:auto" src="/images/pdp11/poll-counter.png" title="RK11-C polling clock"/></p>
<p>A quick look with the 'scope shows no joy here.  This clock is initiated by signal POLL; which doesn't seem to
be being asserted.  Checking the origin of that signal takes us to B26 and A26:</p>
<p><img style="display:block; margin-left:auto; margin-right:auto" src="/images/pdp11/poll-enable.png" title="RK11-C polling clock enable"/></p>
<p>Hmmm, one of these gates (the inverter at A26) is one that had failed and that I had repaired sometime last
year...  Reseated the socketed replacement on A26, reloaded the diagnostic, but still no go.  Well at least
it wasn't my repair job!  Went ahead and pulled A26 and B26 and bench tested the gates.  The 8-input nand
that outputs to B26J2 does look fishy.  Pulled and socketed the piece, and put a replacement and some spares
on order at Jameco where I can pick them up on my way in to work tomorrow.  All for now!</p></div>
    <hr />
</div>



<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/la30-4.html"><h1>PDP-11/45: LA30 repair IV</h1></a>
Sat 09 December 2017

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>Received replacement components for the blown G380 solenoid driver channel.  After this repair, all pins are
firing and printing correctly.  Calibrated left margin.  Checked pin drive signal, which was within
specifications and required no adjustment.</p>
<p>Went to check carriage return pulse timing calibrations, but as it turns out the G396 clock accelerator card
in this LA30 has not had ECO 2 applied and therefore has no timing calibration pots.  Carriage return seems to
be functioning correctly and reliably after the left margin adjustment in any case.</p>
<p>Inspected and cleaned the M7910 interface card; it appears to be in good shape.  Rejumpered the base address
and interrupt vector for console operation. Slotted it into the PDP-11 in place of the DL11 I had been using
up until now, and cabled up to the LA30.  Booted to the M9301 monitor and then on into RT-11, and everything
seems to be working fine!  Here's a short video of the RT-11 boot, followed by the start of a session of
Adventure:</p>
<p><span class="videobox">
                <iframe width="640" height="390"
                    src='https://www.youtube.com/embed/gMIL2bvUYIs?rel=0'
                    frameborder='0' webkitAllowFullScreen mozallowfullscreen
                    allowFullScreen>
                </iframe>
            </span></p></div>
    <hr />
</div>



<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/la30-3.html"><h1>PDP-11/45: LA30 repair III</h1></a>
Sat 02 December 2017

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>Digging in on the flip-flops identified as potentially problematic in the previous post, found that E5 had
failed.  Pulled, socketed, and replaced; character generator now correctly clocks all five character columns:</p>
<p><img style="display:block; margin-left:auto; margin-right:auto" src="/images/pdp11/la30-chargen-clock-
trace-fixed.jpg" title="LA30 character generator clocking trace after repair.  Runs correctly to five character columns"/></p>
<p>After this repair, characters were printing full width, but two problems remained: about half of the
characters printed in response to typing on the keyboard were the wrong character, and the top row was not
printing at all on any character:</p>
<p><img style="display:block; margin-left:auto; margin-right:auto" src="/images/pdp11/la30-second-print.jpg"
title="LA30 second print attempt -- incorrect characters and top row missing"/></p>
<p>Looking at the incorrect characters problem first, it was clear that bit 4 was not being received by the
character generator correctly.  I was a bit worried that the SMC KR2376-17 scanner/ROM on the keyboard
assembly might be at fault, since Mattis had had some trouble with his.  This is a pretty cool part; a
combined scanner and code translator, with an internal oscillator, rollover logic, debounce delay, and
flexible interfacing:</p>
<p><img style="display:block; margin-left:auto; margin-right:auto" src="/images/pdp11/kr2376-schematic.jpg"
title="KR2376-17 keyboard scanner/encoder internal schematic"/></p>
<p>...not to mention the very cool vintage ceramic/gold packaging (see below.)  Fortunately, inspection with an
oscilloscope showed that the outputs from the scanner were just fine; chasing downstream, the problem was
found to be just a loose pin (SS) on the keyboard cable Berg connector.  With that sorted, we now have this:</p>
<p><img style="display:block; margin-left:auto; margin-right:auto" src="/images/pdp11/la30-third-print.jpg"
title="LA30 third print attempt -- characters correct, but still missing top row"/></p>
<p>For the final issue with the top row not printing, verified that the problem followed a particular G380
solenoid driver card when swapping them around, and that with a functional G380 in the appropriate backplane
slot pin 1 fires and prints correctly. Inspection of the problematic G380 revealed a failed power transistor
and blown associated micro-fuse; replacement parts on order.</p>
<p>For the ribbon advance issue, I pulled the ribbon motors and disassembled their top-side reduction gear cases
in order to gain access to the upper rotor bearings.  Cleaning and lubrication of these bearings, plus a few
more taps with a mallet after reassembly, achieved an improved bearing alignment.  With the increased output
torque, the ribbon now advances reliably.</p>
<p>Other minor items: Replacement vibration isolators arrived, and were installed.  Threaded inserts in the
fiberglass top shell that had pulled out were reattached with epoxy.</p>
<p>Have some more travel coming up for work, so may not be able to get back to this for a bit.  Next steps will
be repair of the failed solenoid driver channel, calibrations, then any debug necessary on the M7910 interface
card for the PDP-11.</p>
<p><img src='/images/pdp11/kr2736_thumbnail_tall.jpg' title='The SMC KR2736-17 keyboard scanner/encoder in the LA30' onclick='pswipe("pdp11",74);'/>
<img src='/images/pdp11/G380_thumbnail_tall.jpg' title='G380 solenoid driver card from the LA30, with failed parts pulled' onclick='pswipe("pdp11",75);'/></p></div>
    <hr />
</div>



<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/la30-2.html"><h1>PDP-11/45: LA30 repair II</h1></a>
Sun 26 November 2017

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>Okay, first thing to debug today is the ready light.  This is lit by RDY LITE L, pin A16D2 (lower right of
sheet M7721-0-1 in the LA30 engineering drawings).  Logic probe showed this was correctly asserted low. Pulled
the lamp and checked it with bench supply, and it checked fine.  Verified +10 and ground at the lamp socket as
well, so why isn't it lit?  Turns out it is polarized, and the socket is soldered in backwards (?!). Corrected
the socket, and ready light is working.</p>
<p>Noticed that ribbon is stalling occasionally.  Ribbon tension seems to be overcoming the clutch on the take-up
side.  It seems tensioning drag on the inactive side is too high.  Not sure what to do about this one yet;
there is not much adjustable within the clutches, and the service manual only recommends replacement if they
are out of spec (yeah, good luck finding one!)</p>
<p>Repeated the experiment with loopback jumper (A15R2 to A15C2).  Turns out I had miscounted backplane pins the
first time. With jumper placed correctly, I am now get a printing response to the keyboard.  Not quite right,
but definite progress:</p>
<p><img style="display:block; margin-left:auto; margin-right:auto" src="/images/pdp11/la30-first-print.jpg"
title="LA30 first print attempt"/></p>
<p>Here I had typed <code>:;L</code>, and then some other letters.  You can see evidence of correct pins firing for the
first three characters, though either head movement or pin timing is off.  Letter spacing appears more or less
correct for 80 characters per line.</p>
<p>Okay, hooked up the logic analyzer, and started to take a look at the character generator clocking to see if
all the the columns are being clocked out correctly.  The logic analyzer shows a malfunction consistent with
the print behavior: character column clocking resets after two columns rather than proceeding through all
five:</p>
<p><img style="display:block; margin-left:auto; margin-right:auto" src="/images/pdp11/la30-chargen-clock-
trace.jpg" title="LA30 character generator clocking trace.  Resets incorrectly after only two of five
character columns"/></p>
<p>This signaling is mediated by a ripple counter on the M7724 character generator card:</p>
<p><img style="display:block; margin-left:auto; margin-right:auto" src="/images/pdp11/la30-chargen-schem.jpg"
title="LA30 character generator clocking partial schematic."/></p>
<p>So it looks like one or more of these 7474 quad flops has failed.  I note on my chargen board that these are
early 70's Nat Semi parts; Mattis had a very similar issue (search "7474" on <a href="http://www.datormuseum.se/computers/digital-equipment-corporation/pdp-11-04">this
page</a>) on his LA30 chargen with
the same parts.</p>
<p>All I have time for this weekend; next time I'll get the chip clip on these for a closer look, then pull and
replace the baddies.</p></div>
    <hr />
</div>



<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/la30-repair.html"><h1>PDP-11/45: LA30 repair</h1></a>
Sat 25 November 2017

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>Once again its been a little while since I've had to work on PDP-11 stuff or put any updates here; the <a href="https://www.lsst.org">day
gig</a> has been pretty intense lately.</p>
<p>Recent efforts have been focused on restoration of an LA30 printing terminal.  This was really filthy
(including a mouse nest, yuck) so in addition to the usual electronics work it had to be completely
disassembled for proper cleaning and lubrication.</p>
<p>First off, the H735 power supply.  This is a pretty straightforward supply, but has an oil cap in the ferro-
resonant circuit that is listed as a PCB-containing component; replaced this with a <a href="https://www.digikey.com/product-detail/en/cornell-dubilier-electronics-cde/SFA66S2K156B-F/338-1885-ND/1551444">modern
equivalent</a>.
Also pulled and reformed all the large electrolytic caps on the
bench per usual.  No real trouble or surprises with this supply.</p>
<p>Logic assembly looks good; everything is there (mine is an LA30-P, the parallel interface version) with no
obvious scorches or toast.  Backplane intact and chip pin corrosion doesn't look too bad.  Needed some
compressed air to blow out all the dust bunnies.</p>
<p>Print head also looks to be in decent shape; all of the pins fire freely when activated momentarily with a 15
VDC bench supply.</p>
<p>Most of the work here was involved in disassembling the top section of the terminal, including the keyboard
and carriage assembles, where most of the filth had accumulated. There are a lot of parts and pieces, with
castings, bearings, machined shafts, stainless and brass throughout.  This thing was really well built!</p>
<p>The ribbon-like paper drag springs were all either torn, mangled, or cracked/cracking; I fashioned some
replacements by cutting and drilling 1/2" x 3" strips of .002 steel shim stock.  The rubber shock isolation
mounts for the carriage assembly had also hardened and decayed.
<a href="http://www.vibrationmounts.com/RFQ/VM07003.htm">These</a> look very close to the original; I put some on order.
Replaced the bumpers on the carriage rails with some less expensive 3/8" chassis grommets.  After cleaning,
hit the slide rails with dry film silicone lubricant (Molykote 557) and pivot and carriage cam plates pins
with a good lithium grease (Molykote BR2 Plus).</p>
<p>Ribbon drive motor bearings were very gummy, and one of the ribbon motors had seized.  These motors are quite
serviceable though; you can pull the bottom bearing cap and remove the rotor, clean the rotor shaft and
bearings of old lubricants, apply fresh and reassemble.  These are self-aligning bearings, so don't forget to
give the assembly a few taps all around with a mallet after reassembly to shake them into true.</p>
<p>Consumables: compatible ribbons are still plentiful on eBay, so I ordered a few.  Paper is an unusual width at
9-7/8".  A few vendors on Amazon still seem to carry it, but it might be wise to lay in stock of a carton or
two while it is still obtainable.</p>
<p>Fired it up after reassembly.  No smoke (good!) and it feeps once reassuringly at power on.  Ribbon motors and
clutches seem to be working, and the ribbon advances.  Activating the ribbon reverse switches manually
reverses the ribbon movement per expectation.</p>
<p>If the carriage is closed with paper loaded, the print head will home left and then move right after about a
second or so (per expectation; "last character visibility" feature) and ribbon advance halts.  Local line feed
from the front panel switch works.  All of this indicates a good deal of the logic and the motor drive are
already working correctly.</p>
<p>However: the front panel "ready" indicator does not light, and a quick loopback test (jumper A15R2 to A15C2 on
the backplane) does not print any characters in response to the keyboard.  Will pick up here with logic
debug next time.</p>
<p><img src='/images/pdp11/la30-cap_thumbnail_tall.jpg' title='PCB-containing cap from ferro-resonant supply; to be replaced' onclick='pswipe("pdp11",68);'/>
<img src='/images/pdp11/la30-supply_thumbnail_tall.jpg' title='LA30 H735 supply, pulled to bench for clean/refurb' onclick='pswipe("pdp11",69);'/>
<img src='/images/pdp11/la30-cards_thumbnail_tall.jpg' title='LA30 internal controller card cage' onclick='pswipe("pdp11",70);'/>
<img src='/images/pdp11/la30-head_thumbnail_tall.jpg' title='LA30 print head' onclick='pswipe("pdp11",71);'/>
<img src='/images/pdp11/la30-carriage_thumbnail_tall.jpg' title='LA30 carriage, disassembled for clean, repairs, and lube.  A mangled paper drag spring is visible on the print bar assembly.' onclick='pswipe("pdp11",72);'/>
<img src='/images/pdp11/la30-cleaned_thumbnail_tall.jpg' title='LA30 cleaned and reassembled' onclick='pswipe("pdp11",73);'/></p></div>
    <hr />
</div>



<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/vt52-keyboard.html"><h1>PDP-11/45: VT52 Keyboard Repair</h1></a>
Sat 15 July 2017

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>The VT52 had a broken ESC key, and with RT-11 up and running I was motivated to dig in and fix it (you need
that ESC key if you are going to run the K52 editor).  Pulling the keycap and giving things a look over, the
leaf contacts and the plastic plunger that activate the key looked fine.  Need to get at the keyboard module
itself to troubleshoot, and on a VT52 that means opening the thing all the way up and pulling the main
boards. In we go...</p>
<p>Extracted the keyboard module, powered it from my bench supply, and used a breadboard and some jumpers to
drive the key select decoders.  Key closure on the back of the module was intermittent, but some flexure of
the entire keyboard PCB seemed to be affecting it.  Replaced/reflowed the solder on the back of the key
switch and that seems to have fixed it.</p>
<p>Back together, working well now.  Test drove it for a while under RT-11...</p>
<p><img src='/images/pdp11/vt52-guts_thumbnail_tall.jpg' title='VT52 with logic boards and keyboard removed' onclick='pswipe("pdp11",65);'/>
<img src='/images/pdp11/vt52-keys_thumbnail_tall.jpg' title='VT52 keyboard under test, powered from bench supply' onclick='pswipe("pdp11",66);'/>
<img src='/images/pdp11/rt11-adventure_thumbnail_tall.jpg' title='VT52 test drive with RT-11 Adventure' onclick='pswipe("pdp11",67);'/></p></div>
    <hr />
</div>



<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/data-recovery.html"><h1>PDP-11/45: Data Recovery</h1></a>
Sun 09 July 2017

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>Okay, the system is working well enough now to start attempting recovery and archive of the dozen or so RK05
packs that I have on-hand.  These were all obtained (along with the RK05 drives, controller and power supply)
in a surplus auction downstream of Stanford's Hansen Experimental Physics Lab, sometime in the early '90s.</p>
<p>The packs date from the mid-70's to early-80's, and the labels indicate contents related to experiments and
research projects taking place at the lab at that time.  One particular pack seems associated with the
Stanford Gravity Wave Project, which built early resonant mass detectors.  Other packs labeled "FEL" would
be related to early free-electron laser research.  Many of the names on the packs are are readily found on
related scientific publications from the time.</p>
<p>The process for dealing with these packs involves opening them up for inspection and cleaning before
mounting them, with hopes of avoiding beating up or destroying the drive heads and/or media with head crashes.
Much has been written about pack cleaning on the classiccmp mailing lists and in the vcfed forums, but briefly
the process involves some clean-room gloves, lint-free wipes, and anhydrous isopropyl alcohol.  The
outside of the pack is first cleaned of dust and grime, then the packs are opened and inspected and the disk
surfaces given a scrub with the wipes and alcohol.  If a pack seems in good enough shape to mount, it is spun
up and run in a drive with head load disabled for about a half-hour.  This gets a good air-flow over
the disk to blow out remaining loose particulates and also lets the disk come up to thermal equilibrium.
After that the heads are loaded, with a finger standing by on the unload switch in case there are any bad
noises...</p>
<p>I've already been dealing with two of the packs extensively during the restoration: one is an RKDP
diagnostics pack, and the other was a backup pack of same.  I was able to capture a complete, error-free
image of the RKDP pack using PDP11GUI.  This seems to be an earlier version of this disk that what is
already available on bitsavers; I've sent the bits to Al Kossow, but as I understand it his project has
a big backlog at the moment so it may be a while before he can consider my submission.  In the meantime,
for those interested, the disk image is available <a href="http://www.slac.stanford.edu/~fritzm/data/pdp11/rk05/MAINDEC-11-DZZAA-J-HB.dsk">here</a>.</p>
<p>The RKDP backup disk was used as a test pack during the RK11/RK05 restoration work, and thus was overwritten
by the RK05 diagnostic read/write tests.  It now contains a bootable RT-11 image, written via PDP11GUI.
Mixed results on the other packs so far: some have had severe head crashes (see pic below) or are otherwise
damaged to the point that I am hesitant to mount them.  Some have been mysteriously unreadable.  It looks
like I can expect about 50% recovery.  Results so far are tabulated here.  I hope to be able to make other
recovered images available soon, but since they contain original research materials I am trying to contact
the authors for permission first.</p>
<style>
.disklist { display: inline; border-collapse: collapse; margin-right: 1em; }
.disklist caption { font-weight: bold; }
.disklist tr:nth-child(even) { background-color: #f2f2f2; }
.disklist th, .disklist td { padding: 5px; }
.disklist td { border: 1px solid lightgray; font-family: Menlo,Consolas,monospace; }
</style>

<table class="disklist">
<thead>
<tr><th>Serial #</th><th>Label</th><th>OS</th><th>Notes</th></tr>
</thead>
<tbody><tr>
    <td>ZO 50511</td>
    <td>MAINDEC-11-DZZAA-J-HB 9/21/74 M<br>XXDP RKDP RK11 DIAGNOSTIC PACKAGE</td>
    <td>DZQUD-A RKDP-RK11 MONITOR</td>
    <td>[1974] MAINDEC diagnostics for PDP-11/40/45 CPU/MMU/FPU, MS11, DL11, DR11, RK11, LC11/LA30, KW11-L/P. Full recovery.</td>
</tr><tr>
    <td>B1-75814</td>
    <td>RKDB Backup</td>
    <td>unknown</td>
    <td>[unknown] Presumed to be backup of ZO 50511; used as test disk and overwritten.</td>
</tr><tr>
    <td>B1-28320</td>
    <td><span style="text-decoration:underline;">Gravitational</span> <span style="text-decoration:underline;">Radiation</span> <span style="text-decoration:underline;">Experiment</span><br>Boughn, Hollenhorst, Paik, Sears, Taber MSA</td>
    <td>DOS/BATCH V09-20</td>
    <td>[1976-77] Fortran and MACRO-11 codes, mostly calculations relating to resonant mass detector design. Full recovery.</td>
</tr><tr>
    <td>AD-21279</td>
    <td>BLAZQUEZ RT-11 AUG 83</td>
    <td>RT-11FB (S) V04.00L</td>
    <td>[1983] Fortran and MACRO-11 codes relating to image processing and display.  Device driver code for DeAnza Systems ID-2000 display and Calcomp plotter.  Names: Ken Dinwiddie (DeAnza codes), Art Vetter (Calcomp codes). Full recovery.</td>
</tr><tr>
    <td>BAK 9069 A</td>
    <td>W. COLSON</td>
    <td>DOS/BATCH V9-20C</td>
    <td>[1977-78] Full recovery.</td>
</tr><tr>
    <td>AE 61745</td>
    <td>FEL L.ELIAS</td>
    <td>DOS/BATCH V9-20C</td>
    <td>[1974-78] Head crash on read (ouch!) Partial recovery.  Unrecovered data looks to be mostly OS files; may be patchable.</td>
</tr><tr>
    <td>ZO 50399</td>
    <td>TRANSPORT + DATA<br>1/18/80</td>
    <td>DOS/BATCH V9-20C</td>
    <td>[1980-83] Minor corrosion spot. Partial recovery. Data files and Fortran programs.</td>
</tr><tr>
    <td>E172140</td>
    <td>M. O'Halloran  Ray Tracing<br>R. RAND BBU PROGRAMS</td>
    <td>TBD</td>
    <td>[TBD]</td>
</tr><tr>
    <td>B1-45441</td>
    <td>RT 11</td>
    <td>TBD</td>
    <td>[TBD] Minor head crashes on media.</td>
</tr><tr>
    <td>B1-24056</td>
    <td>RDAS</td>
    <td>DOS/BATCH V9-20C</td>
    <td>[1970-78, 1983] Minor head crashes on media. Partial recovery. FEL related Fortran codes.</td>
</tr><tr>
    <td>AE 20116</td>
    <td>DEACON FEL</td>
    <td>unknown</td>
    <td>[unknown] Many corrosion spots on media; did not mount.</td>
</tr><tr>
    <td>19177</td>
    <td>Transport DOS/BATCH-9 V 20C</td>
    <td>unknown</td>
    <td>[unknown] Major head crash on media; did not mount.</td>
</tr><tr>
    <td>B1-44898</td>
    <td>RDAS9 - V20C</td>
    <td>unknown</td>
    <td>[unknown] Medium head crashes on media; did not mount.</td>
</tr></tbody>
</table>

<p><img src='/images/pdp11/rk05-packs_thumbnail_tall.jpg' title='Some of the RK05 packs obtained in a surplus auction downstream of Stanford&#39;s Hansen Experimental Physics Lab' onclick='pswipe("pdp11",62);'/>
<img src='/images/pdp11/head-crashes_thumbnail_tall.jpg' title='An RK05 disk platter with obvious head crashes' onclick='pswipe("pdp11",63);'/>
<img src='/images/pdp11/gravity-pack_thumbnail_tall.jpg' title='RK05 pack spinning in drive with heads loaded' onclick='pswipe("pdp11",64);'/></p></div>
    <hr />
</div>



<div class='article'>
    <div class="content-title">
        <a href="http://fritzm.github.io/rt11-boots.html"><h1>PDP-11/45: First RT-11 Boot From Disk!</h1></a>
Thu 06 July 2017

by <a class="url fn" href="http://fritzm.github.io/author/fritz-mueller.html">Fritz Mueller</a>
 


    </div>

    <div><p>Not much technical in this post, except the big ticket news: after all the recent repairs and generating a
fresh RT-11 pack <strong>RT-11 BOOTS FROM DISK!</strong></p>
<p>It's been a very long road getting here, but the machine finally has a working, full-featured, operating
system, capable of supporting self-hosted program development.  Spent a few enjoyable hours editing,
assembling, linking, and debugging some small MACRO-11 hacks directly on the machine, using the native RT-11
tools. This is probably a 40 year high-water-mark of functionality for these particular bits of hardware.
Very satisfying!</p>
<p>Next up will be to clean and inspect the dozen or so RK05 packs that I have on hand, and retrieve and
archive whatever content I can.  That should let me clear off a few packs to create some space to
experiment with some additional operating systems, including 6th Edition Unix.</p>
<p><img src='/images/pdp11/rt11-boots_thumbnail_tall.jpg' title='At long last: RT-11 boots from an RK05 pack!' onclick='pswipe("pdp11",61);'/></p></div>
    <hr />
</div>

<div class="pagination">
<ul>
    <li class="prev disabled"><a href="#">&larr; Previous</a></li>

    <li class="active"><a href="http://fritzm.github.io/author/fritz-mueller.html">1</a></li>
    <li class=""><a href="http://fritzm.github.io/author/fritz-mueller2.html">2</a></li>
    <li class=""><a href="http://fritzm.github.io/author/fritz-mueller3.html">3</a></li>
    <li class=""><a href="http://fritzm.github.io/author/fritz-mueller4.html">4</a></li>
    <li class=""><a href="http://fritzm.github.io/author/fritz-mueller5.html">5</a></li>
    <li class=""><a href="http://fritzm.github.io/author/fritz-mueller6.html">6</a></li>

    <li class="next"><a href="http://fritzm.github.io/author/fritz-mueller2.html">Next &rarr;</a></li>

</ul>
</div>
  
        </div>

        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                Site
                </li>

                <li><a href="http://fritzm.github.io/">Archives</a>
                <li><a href="http://fritzm.github.io/tags.html">Tags</a>



                <li><a href="http://fritzm.github.io/feeds/all.rss.xml" rel="alternate" type="application/rss+xml">RSS feed</a></li>

            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                Categories
                </li>

                <li><a href="http://fritzm.github.io/category/math.html">Math</a></li>
                <li><a href="http://fritzm.github.io/category/pdp-11.html">PDP-11</a></li>
                <li><a href="http://fritzm.github.io/category/programming.html">Programming</a></li>
            </ul>
            </div>




            <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                Social
                </li>

                <li><a href="http://facebook.com/fritzmueller">facebook</a></li>
                <li><a href="http://twitter.com/infrafritz">twitter</a></li>
                <li><a href="http://instagram.com/infrafritz">Instagram</a></li>
                <li><a href="http://www.linkedin.com/pub/fritz-mueller/a/679/62/">LinkedIn</a></li>
                <li><a href="http://jsfiddle.net/user/fritzm/fiddles/">JSFiddle</a></li>
                <li><a href="https://github.com/fritzm">GitHub</a></li>
            </ul>
            </div>
            </div>

        </div>     </div>     </div> 
<footer>
<br />
<p><a href="http://fritzm.github.io">fritzm.github.io</a> &copy; Fritz Mueller 2012</p>
</footer>

</div> <!-- /container -->

<!-- Photoswipe -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script>
</body>
</html>